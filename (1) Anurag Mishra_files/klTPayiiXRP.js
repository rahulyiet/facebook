if (self.CavalryLogger) { CavalryLogger.start_js(["CnvrH"]); }

__d("ReactComposerCollageLayoutActor",[],(function a(b,c,d,e,f,g){f.exports={USER:1,PAGE:2};}),null);
__d("ReactComposerJSONCollageLayoutData",[],(function a(b,c,d,e,f,g){f.exports={"2":[{validActors:3,photoLayouts:[[0,3,3,0],[0,6,3,3]]},{validActors:3,photoLayouts:[[0,6,3,0],[3,6,6,0]]},{validActors:3,photoLayouts:[[0,3,6,0],[0,6,6,3]]},{validActors:1,photoLayouts:[[0,6,2,0],[2,6,4,0]]}],"3":[{validActors:3,photoLayouts:[[0,6,3,0],[3,3,6,0],[3,6,6,3]]},{validActors:3,photoLayouts:[[0,3,6,0],[0,6,3,3],[3,6,6,3]]},{validActors:2,photoLayouts:[[0,2,2,0],[0,4,2,2],[0,6,2,4]]},{validActors:1,photoLayouts:[[0,6,4,0],[4,3,6,0],[4,6,6,3]]},{validActors:1,photoLayouts:[[0,4,6,0],[0,6,3,4],[3,6,6,4]]},{validActors:1,photoLayouts:[[0,6,2,0],[2,6,4,0],[4,6,6,0]]},{validActors:1,photoLayouts:[[0,2,6,0],[0,4,6,2],[0,6,6,4]]}],"4":[{validActors:3,photoLayouts:[[0,3,3,0],[0,6,3,3],[3,3,6,0],[3,6,6,3]]},{validActors:3,photoLayouts:[[0,6,4,0],[4,2,6,0],[4,4,6,2],[4,6,6,4]]},{validActors:3,photoLayouts:[[0,4,6,0],[0,6,2,4],[2,6,4,4],[4,6,6,4]]}],"5":[{validActors:1,photoLayouts:[[0,3,3,0],[3,3,6,0],[0,6,2,3],[2,6,4,3],[4,6,6,3]]},{validActors:1,photoLayouts:[[0,3,3,0],[0,6,3,3],[3,2,5,0],[3,4,5,2],[3,6,5,4]]}]};}),null);
__d("ReactComposerMediaAspectTypes",[],(function a(b,c,d,e,f,g){f.exports={LANDSCAPE:"landscape",PORTRAIT:"portrait",SQUARE:"square",PANORAMA_TESTING_ONLY:"panorama",VERTICAL_PANORAMA_TESTING_ONLY:"vertical_panorama"};}),null);
__d('FileHasher',['WebWorker','fileSliceName','emptyFunction','FileHashWorkerResource'],(function a(b,c,d,e,f,g){h.isSupported=function(){'use strict';return c('WebWorker').isSupported();};function h(){'use strict';var i=c('FileHashWorkerResource');c('WebWorker').prepareResource(i);this.$FileHasher1=new (c('WebWorker'))(i).setMessageHandler(function(j){this.$FileHasher2(j);}.bind(this)).execute();}h.prototype.hash=function(i,j){'use strict';this.$FileHasher2=j;this.$FileHasher1.postMessage({file:i,fileSliceName:c('fileSliceName')});return this;};h.prototype.destroy=function(){'use strict';this.$FileHasher2=c('emptyFunction');this.$FileHasher1.terminate();};f.exports=h;}),null);
__d('PagesComposerActionsTypes',['keyMirror'],(function a(b,c,d,e,f,g){var h=c('keyMirror')({BACKDATE:null,SET_DRAFT:null,SCHEDULE:null,SET_ADS_POST:null,SET_BOOSTED_POST:null,SHOW_OFFER_UPSELL:null,ABANDON_OFFER_UPSELL:null,INSTAGRAM_CROSS_POSTING:null});f.exports=h;}),null);
__d("CollageLayoutConfig",[],(function a(b,c,d,e,f,g){var h=4;function i(j,k){var l=arguments.length<=2||arguments[2]===undefined?h:arguments[2],m=arguments[3];"use strict";this.$CollageLayoutConfig2=l;this.$CollageLayoutConfig3=k;this.$CollageLayoutConfig5=m;this.$CollageLayoutConfig6(j);}i.prototype.getItemStyleInfos=function(){"use strict";return this.$CollageLayoutConfig1;};i.prototype.getIndexForPoint=function(j,k){"use strict";var l=this.$CollageLayoutConfig1.findIndex(function(m){return m.left<=j&&m.top<=k&&m.left+m.width>=j&&m.top+m.height>=k;});return l===-1?null:l;};i.prototype.getCalculatedHeight=function(){"use strict";return this.$CollageLayoutConfig4;};i.prototype.getSpacing=function(){"use strict";return this.$CollageLayoutConfig2;};i.prototype.getWidth=function(){"use strict";return this.$CollageLayoutConfig3;};i.prototype.$CollageLayoutConfig6=function(j){"use strict";var k=this.$CollageLayoutConfig7(j),l=this.$CollageLayoutConfig8(j),m=this.$CollageLayoutConfig2*(l-1),n=Math.ceil((this.$CollageLayoutConfig3-m)/l);this.$CollageLayoutConfig4=this.$CollageLayoutConfig5||(n+this.$CollageLayoutConfig2)*k-this.$CollageLayoutConfig2;var o=this.$CollageLayoutConfig2*(k-1),p=Math.ceil((this.$CollageLayoutConfig4-o)/k);this.$CollageLayoutConfig1=[];j.forEach(function(q){var r={left:(n+this.$CollageLayoutConfig2)*q.x,top:(p+this.$CollageLayoutConfig2)*q.y,width:(n+this.$CollageLayoutConfig2)*q.width-this.$CollageLayoutConfig2,height:(p+this.$CollageLayoutConfig2)*q.height-this.$CollageLayoutConfig2};if(r.left+r.width>this.$CollageLayoutConfig3)r.width=this.$CollageLayoutConfig3-r.left;this.$CollageLayoutConfig1.push(r);}.bind(this));};i.prototype.$CollageLayoutConfig8=function(j){"use strict";var k=0;j.forEach(function(l){k=Math.max(k,l.x+l.width);});return k;};i.prototype.$CollageLayoutConfig7=function(j){"use strict";var k=0;j.forEach(function(l){k=Math.max(k,l.y+l.height);});return k;};f.exports=i;}),null);
__d('ReactComposerMediaAspect',['ReactComposerMediaAspectTypes'],(function a(b,c,d,e,f,g){'use strict';f.exports={fromRect:function h(i){return this._fromWidthAndHeight(i.w(),i.h());},fromDimensions:function h(i){return this._fromWidthAndHeight(i[0],i[1]);},_fromWidthAndHeight:function h(i,j){if(i>j){return c('ReactComposerMediaAspectTypes').LANDSCAPE;}else if(i<j){return c('ReactComposerMediaAspectTypes').PORTRAIT;}else return c('ReactComposerMediaAspectTypes').SQUARE;}};}),null);
__d('ReactComposerCollageLayoutModel',['regeneratorRuntime','ReactComposerCollageLayoutActor','ReactComposerMediaAspect'],(function a(b,c,d,e,f,g){var h=[i,j].map(c('regeneratorRuntime').mark);'use strict';function i(l,m){var n,o;return c('regeneratorRuntime').wrap(function p(q){while(1)switch(q.prev=q.next){case 0:n=l.next();o=m.next();if(!(n.done||o.done)){q.next=5;break;}return q.abrupt('break',9);case 5:q.next=7;return [n.value,o.value];case 7:q.next=0;break;case 9:case 'end':return q.stop();}},h[0],this);}function j(l){var m,n,o,p,q;return c('regeneratorRuntime').wrap(function r(s){while(1)switch(s.prev=s.next){case 0:m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();case 1:if(!n){s.next=7;break;}if(!(o>=m.length)){s.next=4;break;}return s.abrupt('break',16);case 4:p=m[o++];s.next=11;break;case 7:o=m.next();if(!o.done){s.next=10;break;}return s.abrupt('break',16);case 10:p=o.value;case 11:q=p;s.next=14;return q;case 14:s.next=1;break;case 16:case 'end':return s.stop();}},h[1],this);}function k(l,m){'use strict';this.$ReactComposerCollageLayoutModel1=!!(l&c('ReactComposerCollageLayoutActor').USER);this.$ReactComposerCollageLayoutModel2=!!(l&c('ReactComposerCollageLayoutActor').PAGE);this.$ReactComposerCollageLayoutModel3=[];if(m)this.addPhotoLayouts(m);}k.prototype.addPhotoLayout=function(l){'use strict';this.$ReactComposerCollageLayoutModel3.push(l);return this;};k.prototype.addPhotoLayouts=function(l){'use strict';l.forEach(function(m){return this.$ReactComposerCollageLayoutModel3.push(m);}.bind(this));return this;};k.prototype.getNumPhotoLayouts=function(){'use strict';return this.$ReactComposerCollageLayoutModel3.length;};k.prototype.getPhotoLayouts=function(){'use strict';return this.$ReactComposerCollageLayoutModel3;};k.prototype.getIsValidForPages=function(){'use strict';return this.$ReactComposerCollageLayoutModel2;};k.prototype.getIsValidForUsers=function(){'use strict';return this.$ReactComposerCollageLayoutModel1;};k.prototype.getIsValidFor=function(l){'use strict';switch(l){case c('ReactComposerCollageLayoutActor').USER:return this.getIsValidForUsers();case c('ReactComposerCollageLayoutActor').PAGE:return this.getIsValidForPages();}return false;};k.prototype.hasMatchingCollagePhotoLayoutType=function(l){'use strict';var m=c('ReactComposerMediaAspect').fromRect(this.$ReactComposerCollageLayoutModel3[0]),n=c('ReactComposerMediaAspect').fromDimensions(l);return m===n;};k.prototype.score=function(l){'use strict';var m=0;for(var n=i(j(this.getPhotoLayouts()),l.values()),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q,s=r[0],t=r[1];if(!t)continue;var u=s.w(),v=s.h(),w=t[0],x=t[1],y=0;if(w===0||x===0){y=0;}else if(u*x/w>=v){var z=u*x/w;y=(z-v)/z;}else if(v*w/x>u){var aa=v*w/x;y=(aa-u)/aa;}m-=y*100;if(x===w){m-=y*5;}else if(u>v){if(w>x){m+=y*25;}else m-=y*25;}else if(u<v){if(w<x){m+=y*25;}else m-=y*25;}else if(u===v)m-=y*5;}m+=200*this.getNumPhotoLayouts();return m;};f.exports=k;}),null);
__d('ReactComposerCollageLayoutData',['ReactComposerCollageLayoutModel','ReactComposerJSONCollageLayoutData','Rect'],(function a(b,c,d,e,f,g){'use strict';var h=[];Object.keys(c('ReactComposerJSONCollageLayoutData')).forEach(function(i){c('ReactComposerJSONCollageLayoutData')[i].forEach(function(j){h.push(new (c('ReactComposerCollageLayoutModel'))(j.validActors,j.photoLayouts.map(function(k){return new (Function.prototype.bind.apply(c('Rect'),[null].concat(k)))();})));});});f.exports=h;}),null);
__d('ReactComposerCollageLayoutSelection',['FBID','Map','ReactComposerCollageLayoutActor','ReactComposerCollageLayoutData'],(function a(b,c,d,e,f,g){'use strict';f.exports={MAX_NUM_COLS:6,MAX_NUM_ROWS:6,_getCollageLayoutsFor:function h(i){return c('ReactComposerCollageLayoutData').filter(function(j){return j.getIsValidFor(i);});},getMaxPhotosSupported:function h(){return Math.max.apply(Math,c('ReactComposerCollageLayoutData').map(function(i){return i.getNumPhotoLayouts();}));},getMaxPhotosSupportedFor:function h(i){return Math.max.apply(Math,this._getCollageLayoutsFor(i).map(function(j){return j.getNumPhotoLayouts();}));},getCollageLayout:function h(i,j){if(j===0)return this.getBestUserCollageLayout(i);var k=c('FBID').isUser(j)?this.getBestUserCollageLayout(i):this.getBestPageCollageLayout(i);return k;},getBestPageCollageLayout:function h(i){if(i.size==0)return new (c('Map'))();var j=i.values().next().value,k=Math.min(this.getMaxPhotosSupportedFor(c('ReactComposerCollageLayoutActor').PAGE),i.size),l=this._getCollageLayoutsFor(c('ReactComposerCollageLayoutActor').PAGE).filter(function(x){return x.getNumPhotoLayouts()===k;});if(!l.length)throw new Error('no valid layout for these media');var m=l.filter(function(x){return x.hasMatchingCollagePhotoLayoutType(j);});if(!m.length)throw new Error('no valid layout for these media starts with a suitable aspect');var n=m[0],o=new (c('Map'))(),p=0,q=n.getPhotoLayouts();for(var r=i.keys(),s=Array.isArray(r),t=0,r=s?r:r[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var u;if(s){if(t>=r.length)break;u=r[t++];}else{t=r.next();if(t.done)break;u=t.value;}var v=u,w=q[p++];if(w)o.set(v,w);}return o;},getBestUserCollageLayout:function h(i){var j=this._getCollageLayoutsFor(c('ReactComposerCollageLayoutActor').USER).filter(function(u){return u.getNumPhotoLayouts()<=i.size;});if(!j.length)throw new Error('no valid layout for these media');var k=this._bestLayoutByScore(j,i);if(!k)throw new Error('no best layout? Should not happen!');var l=new (c('Map'))(),m=0,n=k.getPhotoLayouts();for(var o=i.keys(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r,t=n[m++];if(t)l.set(s,t);}return l;},_bestLayoutByScore:function h(i,j){var k=i.map(function(n){return [n,n.score(j)];}),l=k.reduce(function(n,o){var p=n[0],q=n[1],r=o[0],s=o[1];return q===null||s>q?[r,s]:[p,q];},[null,null]),m=l[0];return m;}};}),null);
__d('ReactComposerCollageUtils',['CollageLayoutConfig','Map','ReactComposerCollageLayoutSelection'],(function a(b,c,d,e,f,g){var h={extractDimensionDataIfValid:function i(j){var k=true,l=new (c('Map'))();j.forEach(function(m){if(!m.width||!m.height){k=false;return;}var n=m.width,o=m.height;if(m.isSpherical)n=o;l.set(m.id,[n,o]);});return k?l:null;},getCollageLayout:function i(j){if(!j||j.size<2)return [];var k=h.extractDimensionDataIfValid(j);if(!k)return [];var l=c('ReactComposerCollageLayoutSelection').getBestUserCollageLayout(k);if(!l)return [];var m=[];for(var n=k.keys(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q,s=l.get(r);if(!s)return [];m.push({x:s.l,y:s.t,width:s.w(),height:s.h()});}return m;},getCollageLayoutConfig:function i(j,k){var l=j.filter(function(n){return n.width&&n.height;}),m=h.getCollageLayout(l);return new (c('CollageLayoutConfig'))(m,k);},getSingleItemStyleInfo:function i(j,k){var l=[],m=k,n=j.width/j.height;if(j.isSpherical)n=1;if(n>1){m=k/n;}else k=n*m;l.push({left:0,top:0,width:k,height:m});return l;}};f.exports=h;}),null);
__d('ReactComposerOptimisticPostingActionType',['keyMirrorRecursive'],(function a(b,c,d,e,f,g){f.exports=c('keyMirrorRecursive')({START_OPTIMISTICALLY_POSTING:null,FINISH_OPTIMISTICALLY_POSTING:null},'ReactComposerOptimisticPostingActionType');}),null);
__d('ReactComposerOptimisticPostingStore',['Arbiter','JSLog','React','ReactComposerActionTypes','ReactComposerEvents','ReactComposerInit','ReactComposerMediaUploadType','ReactComposerOptimisticPostingActionType','ReactComposerOptimisticPostingStoryContainer.react','ReactComposerStoreBase','ReactDOM','ifRequired'],(function a(b,c,d,e,f,g){var h,i,j={};h=babelHelpers.inherits(k,c('ReactComposerStoreBase'));i=h&&h.prototype;function k(){'use strict';var l=function(m){switch(m.type){case c('ReactComposerOptimisticPostingActionType').START_OPTIMISTICALLY_POSTING:this&&this.$ReactComposerOptimisticPostingStore1(m);break;case c('ReactComposerOptimisticPostingActionType').FINISH_OPTIMISTICALLY_POSTING:case c('ReactComposerActionTypes').POST_SUCCEEDED:case c('ReactComposerActionTypes').POST_ERROR:this&&this.$ReactComposerOptimisticPostingStore2(m);break;default:}}.bind(this);i.constructor.call(this,function(){return {hasVideo:null,optimisticallyPostingElement:null};},l);}k.prototype.isOptimisticallyPosting=function(l){'use strict';return !!this.getComposerData(l).optimisticallyPostingElement;};k.prototype.hadOptimisticallyPosted=function(l){'use strict';return !!j[l];};k.prototype.$ReactComposerOptimisticPostingStore3=function(l,m){'use strict';c('Arbiter').inform(c('ReactComposerEvents').OPTIMISTIC_POSTING_STARTED+l);c('Arbiter').inform('LitestandComposer/publishTemp',{composer_id:l,markup:m});c('ReactComposerInit').hideAndReplaceComposer(l);};k.prototype.$ReactComposerOptimisticPostingStore1=function(l){'use strict';var m=this.validateAction(l,['composerID','config','attachmentType','actorID','targetID']),n=m[0],o=m[1],p=m[2],q=m[3],r=m[4],s=this.$ReactComposerOptimisticPostingStore4(c('React').createElement(c('ReactComposerOptimisticPostingStoryContainer.react'),{attachmentType:p,composerID:n,config:o,actorID:q,targetID:r}));this.getComposerData(n).optimisticallyPostingElement=s;c('ifRequired')('ReactComposerMediaUploadStore',function(t){this.getComposerData(n).hasVideo=t.getUploadsOfType(n,c('ReactComposerMediaUploadType').VIDEO).size;}.bind(this),function(){c('JSLog').error("ReactComposerMediaUploadStore isn't loaded when it's supposed "+'to be.');});this.emitChange(n);setTimeout(this.$ReactComposerOptimisticPostingStore3.bind(null,n,s),0);};k.prototype.$ReactComposerOptimisticPostingStore2=function(l){'use strict';var m=this.validateAction(l,['composerID']),n=this.getComposerData(m).optimisticallyPostingElement;if(!n)return;this.getComposerData(m).optimisticallyPostingElement=null;if(!this.getComposerData(m).hasVideo)c('ReactDOM').unmountComponentAtNode(n);j[m]=true;this.emitChange(m);};k.prototype.$ReactComposerOptimisticPostingStore4=function(l){'use strict';var m=document.createElement('div');c('ReactDOM').render(l,m);return m;};f.exports=new k();}),null);
__d('ReactComposerConfig',['ComposerEntryPointRef','ReactComposerLoggingName','ComposerSourceSurface','ComposerTargetData','ComposerTargetType','React','getObjectValues'],(function a(b,c,d,e,f,g){var h=c('React').PropTypes;f.exports=h.shape({actorConfig:h.object,attachmentsConfig:h.object.isRequired,audienceXHP:h.any,contextInfo:h.object,loggingConfig:h.shape({isEditComposer:h.bool,targetType:h.oneOf(c('getObjectValues')(c('ComposerTargetType'))).isRequired,ref:h.oneOf(c('getObjectValues')(c('ComposerEntryPointRef'))).isRequired,composerSourceSurface:h.oneOf(c('getObjectValues')(c('ComposerSourceSurface'))).isRequired}).isRequired,activateOnInit:h.bool,mediaAcceptParam:h.shape({photos:h.string,both:h.string}),nuxConfig:h.object.isRequired,postButtonConfig:h.object,showExpandedComposer:h.bool,taggersConfig:h.object,sproutsConfig:h.object,targetData:h.instanceOf(c('ComposerTargetData')).isRequired,instagramCrossPostingEnabled:h.bool,triggeredFrom:h.oneOf(Object.values(c('ReactComposerLoggingName')))});}),null);
__d('VideoUploadLogger',['Banzai'],(function a(b,c,d,e,f,g){function h(i){this._source=i.source;this._waterfallID=i.waterfall_id;this._targetID=i.target_id;this._delay=i.delay;this._times=[];this._isChunkedUpload=i.is_chunked_upload;this._actorID=i.actor_id;this._composerEntryPointRef=i.composer_entry_point_ref;this._isRemoteUpload=i.is_remote_upload;this._containerType=i.container_type;}Object.assign(h,{BANZAI_GK:'videos',BANZAI_ROUTE:'video_waterfall',SOURCE_SIMPLE:'simple',SOURCE_COMPOSER:'composer',EVENT_STARTED_GENERATE_THUMBNAILS:'upload.client.started_generate_thumbnails',EVENT_FINISHED_GENERATE_THUMBNAILS:'upload.client.finished_generate_thumbnails',EVENT_SELECTED_CUSTOM_THUMBNAIL:'upload.client.selected_custom_thumbnail',EVENT_VIDEO_DIMENSIONS_UNREADABLE:'upload.client.video_dimensions_unreadable',EVENT_REPLACE_VIDEO:'upload.client.replace_video',EVENT_STARTED_FLOW:'upload.client.started_flow',EVENT_FINISHED_FLOW:'upload.client.finished_flow',EVENT_FAILED_FLOW:'upload.client.failed_flow',EVENT_CANCELED_FLOW:'upload.client.canceled_flow',EVENT_RESIGNED_FLOW:'upload.client.resigned_flow',EVENT_REQUESTED_UPLOADING:'upload.client.requested_uploading',EVENT_INVALIDATED_UPLOADING:'upload.client.invalidated_uploading',EVENT_STARTED_UPLOADING:'upload.client.started_uploading',EVENT_PROGRESS_UPLOADING_START_REQUEST:'upload.client.progress_uploading_start_request',EVENT_FINISHED_UPLOADING:'upload.client.finished_uploading',EVENT_CANCELED_UPLOADING:'upload.client.canceled_uploading',EVENT_ABANDONED_UPLOADING:'upload.client.abandoned_uploading',EVENT_FAILED_UPLOADING:'upload.client.failed_uploading',EVENT_STARTED_SENDING_BYTES:'upload.client.started_sending_bytes',EVENT_FINISHED_SENDING_BYTES:'upload.client.finished_sending_bytes',EVENT_CANCELED_SENDING_BYTES:'upload.client.canceled_sending_bytes',EVENT_FAILED_SENDING_BYTES:'upload.client.failed_sending_bytes',EVENT_STARTED_START_REQUEST:'upload.client.started_sending_start_request',EVENT_FINISHED_START_REQUEST:'upload.client.finished_sending_start_request',EVENT_FAILED_START_REQUEST:'upload.client.failed_sending_start_request',EVENT_STARTED_POST_REQUEST:'upload.client.started_sending_post_request',EVENT_FINISHED_POST_REQUEST:'upload.client.finished_sending_post_request',EVENT_FAILED_POST_REQUEST:'upload.client.failed_sending_post_request',EVENT_STARTED_SENDING_CHUNK_BYTES:'upload.client.started_sending_chunk_bytes',EVENT_FINISHED_SENDING_CHUNK_BYTES:'upload.client.finished_sending_chunk_bytes',EVENT_CANCELED_SENDING_CHUNK_BYTES:'upload.client.canceled_sending_chunk_bytes',EVENT_FAILED_SENDING_CHUNK_BYTES:'upload.client.failed_sending_chunk_bytes',EVENT_TIMEOUT_SENDING_CHUNK_BYTES:'upload.client.timeout_sending_chunk_bytes',EVENT_ENCODING_START_OBSERVED:'encode.client.encoding_start_observed',EVENT_ENCODING_SUCCESS_OBSERVED:'encode.client.encoding_success_observed',EVENT_ENCODING_FAIL_OBSERVED:'encode.client.encoding_fail_observed',EVENT_RECEIVED_RESPONSE:'upload.client.received_response',EVENT_STARTED_FLOW_EXP1:'upload.client.started_flow_exp1',EVENT_FINISHED_FLOW_EXP1:'upload.client.finished_flow_exp1',EVENT_CANCELED_FLOW_EXP1:'upload.client.canceled_flow_exp1'});Object.assign(h.prototype,{logEvent:function i(event,j){var k=babelHelpers['extends']({},j);if(k.elapsed_time==null)if(event.indexOf('started')!==-1){this._times[event]=Date.now();}else if(event.indexOf('finished')!==-1){k.elapsed_time=this._computeElapsedTime(event,'finished');}else if(event.indexOf('canceled')!==-1){k.elapsed_time=this._computeElapsedTime(event,'canceled');}else if(event.indexOf('failed')!==-1)k.elapsed_time=this._computeElapsedTime(event,'failed');k.event=event;k.source=this._source;k.waterfall_id=this._waterfallID;k.target_id=this._targetID;k.is_chunked_upload=this._isChunkedUpload;k.actor_id=this._actorID;k.composer_entry_point_ref=this._composerEntryPointRef;k.is_remote_upload=this._isRemoteUpload;k.container_type=this._containerType;c('Banzai').post(h.BANZAI_ROUTE,k,{delay:this._delay,retry:true});},_computeElapsedTime:function i(event,j){var k=event.replace(j,'started'),l=this._times[k];return l?Date.now()-l:null;}});f.exports=h;}),null);
__d('VideoUploadProgressBar',['cx','CSS','VideoUploadFeatureDetector'],(function a(b,c,d,e,f,g,h){function i(j){'use strict';this.$VideoUploadProgressBar1=j.progress_bar;this.$VideoUploadProgressBar2=j.throbber;this.$VideoUploadProgressBar3=j.uploader;this.$VideoUploadProgressBar4=j.start_margin;this.$VideoUploadProgressBar5=j.start_delay;this.$VideoUploadProgressBar6=j.end_margin;this.$VideoUploadProgressBar7=j.end_delay;this.$VideoUploadProgressBar8=j.progress_bar_label;this.$VideoUploadProgressBar9();}i.prototype.reset=function(){'use strict';this.$VideoUploadProgressBar1.setPosition(0);};i.prototype.getRoot=function(){'use strict';return this.$VideoUploadProgressBar1.getRoot();};i.computeProgress=function(j,k,l,m,n){'use strict';var o=Math.min(j+k,l);return o/l*(100-m-n)+m;};i.prototype.$VideoUploadProgressBar9=function(){'use strict';if(c('VideoUploadFeatureDetector').supportsFileAPI()){this.$VideoUploadProgressBar3.subscribe('upload-requested',this.$VideoUploadProgressBar10.bind(this));this.$VideoUploadProgressBar3.subscribe('upload-progressed',this.$VideoUploadProgressBar11.bind(this));this.$VideoUploadProgressBar3.subscribe('online',this.$VideoUploadProgressBar12.bind(this));this.$VideoUploadProgressBar3.subscribe('offline',this.$VideoUploadProgressBar13.bind(this));}else this.$VideoUploadProgressBar3.subscribe('upload-requested',this.$VideoUploadProgressBar14.bind(this));};i.prototype.$VideoUploadProgressBar10=function(event){'use strict';c('CSS').show(this.$VideoUploadProgressBar1.getRoot());c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");this.$VideoUploadProgressBar1.setTarget(this.$VideoUploadProgressBar4,this.$VideoUploadProgressBar5);this.$VideoUploadProgressBar15(0);};i.prototype.$VideoUploadProgressBar15=function(j){'use strict';if(this.$VideoUploadProgressBar8)this.$VideoUploadProgressBar1.changeLabel(''+j.toFixed(1)+'%');};i.prototype.$VideoUploadProgressBar11=function(event,j){'use strict';c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");var k=i.computeProgress(j.start_offset,j.sent_bytes,j.file_size,this.$VideoUploadProgressBar4,this.$VideoUploadProgressBar6);this.$VideoUploadProgressBar1.setPosition(k);this.$VideoUploadProgressBar15(k);if(k>=100-this.$VideoUploadProgressBar6){this.$VideoUploadProgressBar1.setTarget(100,this.$VideoUploadProgressBar7);this.$VideoUploadProgressBar15(100);}};i.prototype.$VideoUploadProgressBar12=function(event){'use strict';c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");};i.prototype.$VideoUploadProgressBar13=function(event){'use strict';c('CSS').addClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");};i.prototype.$VideoUploadProgressBar14=function(event){'use strict';c('CSS').show(this.$VideoUploadProgressBar2);};f.exports=i;}),null);
__d('VideoUploadCrashMonitor',['Bandicoot','VideoUploadLogger'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('Bandicoot'));i=h&&h.prototype;function j(k,l,m,n,o,p,q,r){'use strict';i.constructor.call(this,'VideoUploadSession');this.$VideoUploadCrashMonitor1={waterfallID:k,actorID:l,source:m,targetID:n,loggingDelay:o,supportsChunking:p,composerEntryPointRef:q,flowStarted:r};}j.prototype.flowStarted=function(){'use strict';this.$VideoUploadCrashMonitor1.flowStarted=true;};j.prototype.getCrashTimeData=function(){'use strict';return this.$VideoUploadCrashMonitor1;};j.prototype.logCrash=function(k,l,m){'use strict';if(!l.waterfallID)return;var n=new (c('VideoUploadLogger'))({actor_id:l.actorID,source:l.source,waterfall_id:l.waterfallID,target_id:l.targetID,delay:l.loggingDelay,is_chunked_upload:l.supportsChunking,composer_entry_point_ref:l.composerEntryPointRef}),o={error:'Crash Detected',error_description:'Detected video upload did not complete due to a crash'};n.logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,o);if(l.flowStarted)n.logEvent(c('VideoUploadLogger').EVENT_RESIGNED_FLOW,{});};f.exports=j;}),null);
__d('VideoUploadFileValidator',['errorCode','fbt','ErrorDialog','ImageExtensions','Link.react','React'],(function a(b,c,d,e,f,g,h,i){var j=[1363019,1363020,1363021,1363022,1363023,1363024,1363025,1363026,1363027,1363030,1363031,1363032,1363033,1363038,1363039,1363040,1363048],k=['VIDEO__INVALID_GUIDE_DATA'];function l(m){'use strict';this.$VideoUploadFileValidator1=m;}l.prototype.validate=function(m,n){'use strict';return this.$VideoUploadFileValidator2(m)&&this.$VideoUploadFileValidator3(m)&&this.$VideoUploadFileValidator4(m.getExtension()===c('ImageExtensions').GIF,n);};l.prototype.getValidationErrorMessage=function(m,n){'use strict';return this.$VideoUploadFileValidator5(m)||this.$VideoUploadFileValidator6(m)||this.$VideoUploadFileValidator7(m.getExtension()===c('ImageExtensions').GIF,n);};l.canReplaceVideoForError=function(m){'use strict';if(!m)return true;if(k.indexOf(m)>-1)return false;if(j.indexOf(m)>-1)return true;return false;};l.prototype.$VideoUploadFileValidator2=function(m){'use strict';var n=this.$VideoUploadFileValidator5(m);if(n){c('ErrorDialog').show(n.summary,n.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator5=function(m){'use strict';if(this.$VideoUploadFileValidator1.extensions[m.getExtension()])return;var n="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",o=c('React').createElement(c('Link.react'),{href:n},i._("recommended formats"));return {summary:i._("Unsupported File Format"),description:i._("Sorry, the file you selected is in a format that we don't support. Please use one of our {link} for video files.",[i.param('link',o)])};};l.prototype.$VideoUploadFileValidator3=function(m){'use strict';var n=this.$VideoUploadFileValidator6(m);if(n){c('ErrorDialog').show(n.summary,n.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator6=function(m){'use strict';var n;if(m.getSize()===null)return;if(m.getSize()<this.$VideoUploadFileValidator1.minSize)n=this.$VideoUploadFileValidator8();if(m.getSize()>this.$VideoUploadFileValidator1.maxSize)n=this.$VideoUploadFileValidator9();return n;};l.prototype.$VideoUploadFileValidator8=function(){'use strict';var m=Math.round(this.$VideoUploadFileValidator1.minSize/1024);return {summary:i._("Video File Too Small"),description:i._("The video file you tried to upload is too small. The minimum size for a video file is {min-size} KB. Please try again with a larger file.",[i.param('min-size',m)])};};l.prototype.$VideoUploadFileValidator9=function(){'use strict';var m=this.$VideoUploadFileValidator1.maxSize/1024/1024;return {summary:i._("Video File Too Large"),description:i._("The video file you tried to upload is too large. The maximum size for a video file is {max-size} MB. Please try again with a smaller file.",[i.param('max-size',m)])};};l.prototype.$VideoUploadFileValidator4=function(m,n){'use strict';var o=this.$VideoUploadFileValidator7(m,n);if(o){c('ErrorDialog').show(o.summary,o.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator7=function(m,n){'use strict';var o;if(!n)return;var p=n.format.duration;if(p>this.$VideoUploadFileValidator1.maxLength)o=this.$VideoUploadFileValidator10();if(p<this.$VideoUploadFileValidator1.minLength&&!m)o=this.$VideoUploadFileValidator11();if(!n.streams.primaryVideo&&n.streams.primaryAudio)o=this.$VideoUploadFileValidator12();if(n.streams.primaryVideo.width<this.$VideoUploadFileValidator1.minWidth)o=this.$VideoUploadFileValidator13();if(n.streams.primaryVideo.height<this.$VideoUploadFileValidator1.minHeight)o=this.$VideoUploadFileValidator14();var q=n.streams.primaryVideo.width/n.streams.primaryVideo.height;if(this.$VideoUploadFileValidator1.require16to9AspectRatio)if(q>2||q<1.6)o=this.$VideoUploadFileValidator15();if(this.$VideoUploadFileValidator1.minAspectRatio)if(q<this.$VideoUploadFileValidator1.minAspectRatio)o=this.$VideoUploadFileValidator16();if(this.$VideoUploadFileValidator1.maxAspectRatio)if(q>this.$VideoUploadFileValidator1.maxAspectRatio)o=this.$VideoUploadFileValidator17();return o;};l.prototype.$VideoUploadFileValidator10=function(){'use strict';if(this.$VideoUploadFileValidator1.source==='profile_video'){return {summary:i._("Profile video duration too long"),description:i._("The maximum length is {max-length} seconds. Please upload a shorter video.",[i.param('max-length',this.$VideoUploadFileValidator1.maxLength)])};}else return {summary:i._("Video duration too long"),description:i._("The duration of the video you tried to upload is too long. The maximum duration for a video is {max-length} minutes. Please upload a shorter video.",[i.param('max-length',Math.round(this.$VideoUploadFileValidator1.maxLength/60))])};};l.prototype.$VideoUploadFileValidator11=function(){'use strict';return {summary:i._("Video file too short"),description:i._({"second":"The duration of the video that you tried to upload is too short. The minimum length for a video is {min-length} second. Please upload a longer video.","seconds":"The duration of the video that you tried to upload is too short. The minimum length for a video is {min-length} seconds. Please upload a longer video."},[i.param('min-length',this.$VideoUploadFileValidator1.minLength),i['enum'](this.$VideoUploadFileValidator1.minLength===1?'second':'seconds',{second:'second',seconds:'seconds'})])};};l.prototype.$VideoUploadFileValidator12=function(){'use strict';var m="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",n=c('React').createElement(c('Link.react'),{href:m},i._("supported video format"));return {summary:i._("No video detected"),description:i._("It looks like you're trying to upload a file that isn't a video. Please try uploading a {supported-video-format link}",[i.param('supported-video-format link',n)])};};l.prototype.$VideoUploadFileValidator13=function(){'use strict';return {summary:i._("Video width too narrow"),description:i._("The width of the video you tried to upload is too short. The minimum width for a video is {min-width}. Please upload a wider video.",[i.param('min-width',this.$VideoUploadFileValidator1.minWidth)])};};l.prototype.$VideoUploadFileValidator15=function(){'use strict';return {summary:i._("Problem with uploading video"),description:i._("Videos look best when they have a 16:9 aspect ratio. Please edit your video and upload it again.")};};l.prototype.$VideoUploadFileValidator14=function(){'use strict';return {summary:i._("Video height too short"),description:i._("The height of the video you tried to upload is too short. The minimum height for a video is {min-height}. Please upload a taller video.",[i.param('min-height',this.$VideoUploadFileValidator1.minHeight)])};};l.prototype.$VideoUploadFileValidator17=function(){'use strict';return {summary:i._("Aspect ratio too big"),description:i._("The video you've selected is too wide. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}.",[i.param('max_aspect_ratio',this.$VideoUploadFileValidator1.maxAspectRatio+':1'),i.param('min_aspect_ratio',this.$VideoUploadFileValidator1.minAspectRatio+':1')])};};l.prototype.$VideoUploadFileValidator16=function(){'use strict';return {summary:i._("Aspect ratio too low"),description:i._("The video you've selected is too tall. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}.",[i.param('max_aspect_ratio',this.$VideoUploadFileValidator1.maxAspectRatio+':1'),i.param('min_aspect_ratio',this.$VideoUploadFileValidator1.minAspectRatio+':1')])};};f.exports=l;}),null);
__d('VideoUploadRequest',['AsyncRequest','DOM','DTSG','FileForm','Form','PHPQuerySerializer','VideoUploadFeatureDetector','emptyFunction','flattenPHPQueryData','submitForm'],(function a(b,c,d,e,f,g){var h='video';function i(j){'use strict';this.$VideoUploadRequest1=j;this.$VideoUploadRequest2=null;this.$VideoUploadRequest3=false;this.$VideoUploadRequest4=null;this.$VideoUploadRequest5=null;this.$VideoUploadRequest6=null;this.$VideoUploadRequest7=null;this.$VideoUploadRequest8=c('emptyFunction');this.$VideoUploadRequest9=c('emptyFunction');this.$VideoUploadRequest10=c('emptyFunction');this.$VideoUploadRequest11=c('emptyFunction');this.$VideoUploadRequest12=null;}i.prototype.setAllowCrossOrigin=function(j){'use strict';this.$VideoUploadRequest3=j;return this;};i.prototype.setData=function(j){'use strict';this.$VideoUploadRequest4=j;return this;};i.prototype.setWaterfallID=function(j){'use strict';this.$VideoUploadRequest6=j;return this;};i.prototype.setSuccessHandler=function(j){'use strict';this.$VideoUploadRequest8=j;return this;};i.prototype.setErrorHandler=function(j){'use strict';this.$VideoUploadRequest9=j;return this;};i.prototype.setTransportErrorHandler=function(j){'use strict';this.$VideoUploadRequest10=j;return this;};i.prototype.setUploadProgressHandler=function(j){'use strict';this.$VideoUploadRequest11=j;return this;};i.prototype.setTimeoutHandler=function(j,k){'use strict';this.$VideoUploadRequest7=j;this.$VideoUploadRequest12=k;return this;};i.prototype.setThumbnail=function(j){'use strict';this.$VideoUploadRequest13=j;return this;};i.prototype.setHandle=function(j){'use strict';this.$VideoUploadRequest5=j;return this;};i.prototype.setCaptions=function(j){'use strict';this.$VideoUploadRequest14=j;return this;};i.prototype.send=function(){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');if(c('VideoUploadFeatureDetector').supportsXHR()){this.$VideoUploadRequest2=this.$VideoUploadRequest15();if(this.$VideoUploadRequest13||this.$VideoUploadRequest14){var j=new FormData();if(this.$VideoUploadRequest13)j.append('thumb',this.$VideoUploadRequest13);if(this.$VideoUploadRequest14)this.$VideoUploadRequest14.forEach(function(l,m){var n=l.getIsDefault()?'captions_default':'captions_file'+m;j.append(n,l.getFile());});if(this.$VideoUploadRequest4){var k=c('flattenPHPQueryData')(this.$VideoUploadRequest4);Object.keys(k).forEach(function(l){j.append(l,k[l]);});}this.$VideoUploadRequest2.setRawData(j);}this.$VideoUploadRequest2.send();}else{this.$VideoUploadRequest2=this.$VideoUploadRequest16();this.$VideoUploadRequest17(this.$VideoUploadRequest2);}};i.prototype.sendChunk=function(j){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');var k=new FormData();if(this.$VideoUploadRequest5){k.append('fbuploader_video_file_chunk',this.$VideoUploadRequest5);}else k.append('video_file_chunk',j);this.$VideoUploadRequest2=this.$VideoUploadRequest15();this.$VideoUploadRequest2.setRawData(k);this.$VideoUploadRequest2.send();};i.prototype.sendFile=function(j){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');this.$VideoUploadRequest2=this.$VideoUploadRequest16();var k=j.cloneNode(false);j.name=h;c('DOM').replace(j,k);c('DOM').appendContent(this.$VideoUploadRequest2.getRoot(),j);this.$VideoUploadRequest17(this.$VideoUploadRequest2);j.name=k.name;c('DOM').replace(k,j);};i.prototype.abort=function(){'use strict';if(!this.$VideoUploadRequest2)throw new Error('There is no upload request in progress.');this.$VideoUploadRequest2.abort();this.$VideoUploadRequest2=null;};i.prototype.$VideoUploadRequest15=function(){'use strict';var j=this.__getAsyncRequest().setAllowCrossOrigin(this.$VideoUploadRequest3).setURI(this.$VideoUploadRequest1).setData(this.$VideoUploadRequest4).setRequestHeader('X_FB_VIDEO_WATERFALL_ID',this.$VideoUploadRequest6).setHandler(this.$VideoUploadRequest8).setErrorHandler(this.$VideoUploadRequest9).setTransportErrorHandler(this.$VideoUploadRequest10).setUploadProgressHandler(this.$VideoUploadRequest11);if(this.$VideoUploadRequest12)j.setTimeoutHandler(this.$VideoUploadRequest7,this.$VideoUploadRequest12);return j;};i.prototype.__getAsyncRequest=function(){'use strict';return new (c('AsyncRequest'))();};i.prototype.$VideoUploadRequest16=function(){'use strict';var j=c('DOM').create('form',{action:this.$VideoUploadRequest1,method:'POST'});c('Form').createHiddenInputs(babelHelpers['extends']({fb_dtsg:c('DTSG').getToken()},this.$VideoUploadRequest4),j);var k=new (c('FileForm'))(j,null,{allowCrossOrigin:this.$VideoUploadRequest3});k.subscribe('success',this.$VideoUploadRequest18.bind(this));k.subscribe('failure',this.$VideoUploadRequest19.bind(this));k.subscribe('progress',this.$VideoUploadRequest20.bind(this));return k;};i.prototype.$VideoUploadRequest17=function(j){'use strict';c('DOM').appendContent(document.body,j.getRoot());c('submitForm')(j.getRoot());};i.prototype.$VideoUploadRequest18=function(event,j){'use strict';this.$VideoUploadRequest8(j.response);};i.prototype.$VideoUploadRequest19=function(event,j){'use strict';this.$VideoUploadRequest9(j.response);};i.prototype.$VideoUploadRequest20=function(event,j){'use strict';this.$VideoUploadRequest11(j.event);};f.exports=i;}),null);
__d('VideoUploadPostRequestManager',['ArbiterMixin','VideoUploadRequest','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o){'use strict';i.constructor.call(this);this.$VideoUploadPostRequestManager1=k;this.$VideoUploadPostRequestManager2=l;this.$VideoUploadPostRequestManager3=m;this.$VideoUploadPostRequestManager4=0;this.$VideoUploadPostRequestManager5=n;this.$VideoUploadPostRequestManager6=o;this.$VideoUploadPostRequestManager7=0;}j.prototype.getRequest=function(){'use strict';return this.$VideoUploadPostRequestManager8;};j.prototype.sendRequest=function(k){'use strict';if(this.$VideoUploadPostRequestManager8)return;this.$VideoUploadPostRequestManager9=babelHelpers['extends']({},k.getMetadata(),this.__createRequestData(k));this.$VideoUploadPostRequestManager10=this.$VideoUploadPostRequestManager9.thumb;delete this.$VideoUploadPostRequestManager9.thumb;this.$VideoUploadPostRequestManager11=this.$VideoUploadPostRequestManager9.captions;delete this.$VideoUploadPostRequestManager9.captions;this.$VideoUploadPostRequestManager12=k.getWaterfallID();this.$VideoUploadPostRequestManager13();this.inform('request-started');};j.prototype.$VideoUploadPostRequestManager13=function(){'use strict';clearTimeout(this.$VideoUploadPostRequestManager14);this.$VideoUploadPostRequestManager14=null;this.$VideoUploadPostRequestManager8=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager1).setAllowCrossOrigin(true).setData(this.$VideoUploadPostRequestManager9).setThumbnail(this.$VideoUploadPostRequestManager10).setCaptions(this.$VideoUploadPostRequestManager11).setWaterfallID(this.$VideoUploadPostRequestManager12).setSuccessHandler(this.$VideoUploadPostRequestManager15.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager16.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager17.bind(this));this.$VideoUploadPostRequestManager8.send();};j.prototype.__createRequestData=function(k){'use strict';return {video_id:k.getVideoID(),target_id:k.getTargetID(),source:k.getSource(),waterfall_id:k.getWaterfallID(),creator_product:k.getCreatorProduct(),composer_entry_point_ref:k.getComposerEntryPointRef&&k.getComposerEntryPointRef(),supports_chunking:k.getSupportsChunking()};};j.prototype.__getVideoUploadRequest=function(k){'use strict';return new (c('VideoUploadRequest'))(k);};j.prototype.clearRequest=function(){'use strict';this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager7=0;this.$VideoUploadPostRequestManager4=0;};j.prototype.isInProgress=function(){'use strict';return !!this.$VideoUploadPostRequestManager8;};j.prototype.$VideoUploadPostRequestManager18=function(k){'use strict';clearTimeout(this.$VideoUploadPostRequestManager14);this.$VideoUploadPostRequestManager14=setTimeout(this.$VideoUploadPostRequestManager13.bind(this),k);};j.prototype.$VideoUploadPostRequestManager19=function(k,l){'use strict';return Math.pow(k,l)*1000;};j.prototype.$VideoUploadPostRequestManager15=function(k){'use strict';var l=k.getPayload();this.inform('request-finished',{video_id:l.video_id,video_asset_id:l.video_asset_id,container_type:l.container_type,transport_retries:this.$VideoUploadPostRequestManager4,server_retries:this.$VideoUploadPostRequestManager7});this.clearRequest();};j.prototype.$VideoUploadPostRequestManager20=function(k){'use strict';this.inform('request-failed',{error_code:k.getError(),error_description:k.getErrorDescription(),error_summary:k.getErrorSummary(),transport_retries:this.$VideoUploadPostRequestManager4,server_retries:this.$VideoUploadPostRequestManager7,error_is_transient:k.isTransient()});this.clearRequest();};j.prototype.$VideoUploadPostRequestManager16=function(k){'use strict';this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager4=0;if(k.isTransient()&&this.$VideoUploadPostRequestManager7<this.$VideoUploadPostRequestManager5){this.$VideoUploadPostRequestManager7++;this.$VideoUploadPostRequestManager18(this.$VideoUploadPostRequestManager19(this.$VideoUploadPostRequestManager6,this.$VideoUploadPostRequestManager7));}else this.$VideoUploadPostRequestManager20(k);};j.prototype.$VideoUploadPostRequestManager17=function(k){'use strict';if(this.$VideoUploadPostRequestManager2===0||this.$VideoUploadPostRequestManager4>=this.$VideoUploadPostRequestManager2){this.$VideoUploadPostRequestManager20(k);}else{this.$VideoUploadPostRequestManager4++;this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager18(this.$VideoUploadPostRequestManager19(this.$VideoUploadPostRequestManager3,this.$VideoUploadPostRequestManager4));}};f.exports=j;}),null);
__d('ResumableUploadServiceState.enum',[],(function a(b,c,d,e,f,g){'use strict';var h={CANCEL:'upload-cancel',FAIL:'upload-fail',FILE_TOO_LARGE:'upload-too-large',NOT_STARTED:'upload-not-started',PROGRESS:'upload-progress',START:'upload-start',SUCCESS:'upload-success',TRANSPORT_FAILURE:'upload-transport-fail'};f.exports=h;}),null);
__d('ResumableUploadService',['Promise','AsyncRequest','EventEmitter','ResumableUploadServiceState.enum','URI','uuid'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('EventEmitter'));i=h&&h.prototype;function j(k,l,m,n,o){i.constructor.call(this);this.consumer=k;this.accessToken=l;this.sessionKey=m||c('uuid')();this.contentKey=n||'';this.contentValue=o||'';}j.prototype.resume=function(k){var l=new (c('URI'))('https://rupload.facebook.com/'+this.consumer+'/'+this.sessionKey);if(this.contentKey&&this.contentValue)l=l.addQueryData(this.contentKey,this.contentValue);var m=function(){return new (c('Promise'))(function(q,r){new (c('AsyncRequest'))().disableArtilleryTracing().setAllowCrossOrigin(true).setAllowCredentials(false).setMethod('GET').setURI(l).setReadOnly(true).setRequestHeader('Authorization','OAuth '+this.accessToken).setHandler(q).setErrorHandler(r).setOption('suppressEvaluation',true).setTransportErrorHandler(function(event){this.emit(c('ResumableUploadServiceState.enum').TRANSPORT_FAILURE,event);}.bind(this)).send();}.bind(this));}.bind(this),n=function(q){return new (c('Promise'))(function(r,s){var t=JSON.parse(q.payload.response),u=t.offset;this.emit(c('ResumableUploadServiceState.enum').START,{offset:u});this.uploadAsyncRequest=new (c('AsyncRequest'))().disableArtilleryTracing().setAllowCrossOrigin(true).setAllowCredentials(false).setURI(l).setRawData(k.slice(u)).setHandler(r).setErrorHandler(s).setRequestHeader('Authorization','OAuth '+this.accessToken).setRequestHeader('X-Entity-Name',encodeURIComponent(k.name)).setRequestHeader('X-Entity-Type',k.type).setRequestHeader('X-Entity-Length',String(k.size)).setRequestHeader('Offset',String(u)).setOption('suppressEvaluation',true).setUploadProgressHandler(function(event){this.emit(c('ResumableUploadServiceState.enum').PROGRESS,event);}.bind(this)).setTransportErrorHandler(function(event){this.emit(c('ResumableUploadServiceState.enum').TRANSPORT_FAILURE,event);}.bind(this));this.uploadAsyncRequest.send();}.bind(this));}.bind(this),o=function(q){if(q!=null){var r=JSON.parse(q.payload.response);this.emit(c('ResumableUploadServiceState.enum').SUCCESS,r.h);}else this.emit(c('ResumableUploadServiceState.enum').FAIL,'uploading failed');}.bind(this),p=function(q){return this.emit(c('ResumableUploadServiceState.enum').FAIL,q);}.bind(this);return m().then(n,p).then(o,p);};j.prototype.cancel=function(){this.uploadAsyncRequest&&this.uploadAsyncRequest.abort();this.emit(c('ResumableUploadServiceState.enum').CANCEL);};f.exports=j;}),null);
__d('VideoUploadConnectionMonitor',['ArbiterMixin','Network','VideoUploadFeatureDetector','debounce','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(){'use strict';i.constructor.call(this);this.$VideoUploadConnectionMonitor1=false;this.$VideoUploadConnectionMonitor2=[];this.$VideoUploadConnectionMonitor3=false;this.$VideoUploadConnectionMonitor4=true;this.$VideoUploadConnectionMonitor5=c('debounce')(function(){this.$VideoUploadConnectionMonitor6(false);}.bind(this),2000);}j.prototype.notifyStart=function(){'use strict';if(this.$VideoUploadConnectionMonitor3)return;if(this.$VideoUploadConnectionMonitor2.length===0){this.$VideoUploadConnectionMonitor2.push(c('Network').addListener('online',function(){this.$VideoUploadConnectionMonitor6(true);}.bind(this)));this.$VideoUploadConnectionMonitor2.push(c('Network').addListener('offline',function(){if(this.$VideoUploadConnectionMonitor1){this.$VideoUploadConnectionMonitor5();}else{this.$VideoUploadConnectionMonitor5.reset();setTimeout(this.$VideoUploadConnectionMonitor5,2000);}}.bind(this)));}this.$VideoUploadConnectionMonitor3=true;};j.prototype.notifyProgress=function(event){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;if(!event)return;if(c('VideoUploadFeatureDetector').supportsFullProgress()){this.$VideoUploadConnectionMonitor1=true;if(event.total&&event.loaded===event.total){this.$VideoUploadConnectionMonitor5.reset();}else this.$VideoUploadConnectionMonitor5();}};j.prototype.notifySuccess=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(true);};j.prototype.notifyTransportError=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor3=false;this.$VideoUploadConnectionMonitor6(false);};j.prototype.notifyError=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(true);};j.prototype.isOnline=function(){'use strict';return this.$VideoUploadConnectionMonitor4;};j.prototype.reset=function(){'use strict';while(this.$VideoUploadConnectionMonitor2.length)this.$VideoUploadConnectionMonitor2.pop().remove();this.$VideoUploadConnectionMonitor5.reset();this.$VideoUploadConnectionMonitor3=false;};j.prototype.$VideoUploadConnectionMonitor6=function(k){'use strict';this.$VideoUploadConnectionMonitor5.reset();if(this.$VideoUploadConnectionMonitor4!==k){this.$VideoUploadConnectionMonitor4=k;if(this.$VideoUploadConnectionMonitor4){this.inform('online');}else this.inform('offline');}};f.exports=j;}),null);
__d('VideoUploadReceiveRequestManager',['fbt','ArbiterMixin','VideoUploadConnectionMonitor','VideoUploadRequest','VideoUploadConfig','ResumableUploadService','ResumableUploadServiceState.enum','md5','mixin'],(function a(b,c,d,e,f,g,h){var i,j,k=1363037;i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n,o,p,q,r,s,t,u){'use strict';j.constructor.call(this);this.$VideoUploadReceiveRequestManager1=m;this.$VideoUploadReceiveRequestManager2=n;this.$VideoUploadReceiveRequestManager3=o;this.$VideoUploadReceiveRequestManager4=p;this.$VideoUploadReceiveRequestManager5=q;this.$VideoUploadReceiveRequestManager6=r;this.$VideoUploadReceiveRequestManager7=s;this.$VideoUploadReceiveRequestManager8=t;this.$VideoUploadReceiveRequestManager9=u;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager13=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager16='constructed';this.$VideoUploadReceiveRequestManager17=null;this.$VideoUploadReceiveRequestManager18=new (c('VideoUploadConnectionMonitor'))();this.$VideoUploadReceiveRequestManager18.subscribe('online',this.$VideoUploadReceiveRequestManager19.bind(this));this.$VideoUploadReceiveRequestManager18.subscribe('offline',this.$VideoUploadReceiveRequestManager20.bind(this));}l.prototype.sendRequest=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='sending request';if(this.$VideoUploadReceiveRequestManager21){this.$VideoUploadReceiveRequestManager16='request already in progress';return;}this.$VideoUploadReceiveRequestManager15=m.getEndOffset()-m.getStartOffset();this.$VideoUploadReceiveRequestManager22=m;this.$VideoUploadReceiveRequestManager23();};l.prototype.cancelRequest=function(){'use strict';if(!this.$VideoUploadReceiveRequestManager21)return;this.$VideoUploadReceiveRequestManager21.abort();if(this.$VideoUploadReceiveRequestManager17!==null)this.$VideoUploadReceiveRequestManager17.cancel();this.$VideoUploadReceiveRequestManager24();};l.prototype.appendStateLogData=function(m,n){'use strict';m[n+'last_log_entry']=this.$VideoUploadReceiveRequestManager16;m[n+'upload_speed']=this.$VideoUploadReceiveRequestManager14;m[n+'transport_retries']=this.$VideoUploadReceiveRequestManager10;m[n+'server_retries']=this.$VideoUploadReceiveRequestManager11;m[n+'timeout_retries']=this.$VideoUploadReceiveRequestManager12;m[n+'last_timeout_value']=this.$VideoUploadReceiveRequestManager25;m[n+'last_request_start_time']=this.$VideoUploadReceiveRequestManager13;m[n+'pending_request']=this.$VideoUploadReceiveRequestManager21!=null;m[n+'pending_timer']=this.$VideoUploadReceiveRequestManager26!=null;m[n+'cached_chunk']=this.$VideoUploadReceiveRequestManager27!=null;if(this.$VideoUploadReceiveRequestManager22!=null){m[n+'start_offset']=this.$VideoUploadReceiveRequestManager22.getStartOffset();m[n+'end_offset']=this.$VideoUploadReceiveRequestManager22.getEndOffset();m[n+'partition_start_offset']=this.$VideoUploadReceiveRequestManager22.getPartitionStartOffset();m[n+'partition_end_offset']=this.$VideoUploadReceiveRequestManager22.getPartitionEndOffset();}if(this.$VideoUploadReceiveRequestManager18!=null)m[n+'connection_monitor_online']=this.$VideoUploadReceiveRequestManager18.isOnline();};l.prototype.$VideoUploadReceiveRequestManager24=function(){'use strict';this.$VideoUploadReceiveRequestManager21=null;this.$VideoUploadReceiveRequestManager27=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager13=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager22.reset();this.$VideoUploadReceiveRequestManager18.reset();clearTimeout(this.$VideoUploadReceiveRequestManager26);this.$VideoUploadReceiveRequestManager26=null;};l.prototype.$VideoUploadReceiveRequestManager23=function(m){'use strict';clearTimeout(this.$VideoUploadReceiveRequestManager26);this.$VideoUploadReceiveRequestManager26=null;if(this.$VideoUploadReceiveRequestManager22.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager22.getStartOffset()>=this.$VideoUploadReceiveRequestManager22.getPartitionEndOffset()){if(!m){this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManager22.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManager22.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager16='request finished - notified';}else this.$VideoUploadReceiveRequestManager16='request finished - not notified';return;}this.$VideoUploadReceiveRequestManager21=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager1).setAllowCrossOrigin(true).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager22)).setWaterfallID(this.$VideoUploadReceiveRequestManager22.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManager28.bind(this));if(!c('VideoUploadConfig').resumability_enabled)this.$VideoUploadReceiveRequestManager21.setUploadProgressHandler(this.$VideoUploadReceiveRequestManager29.bind(this));this.$VideoUploadReceiveRequestManager13=Date.now();if(this.$VideoUploadReceiveRequestManager22.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager4){var n=this.$VideoUploadReceiveRequestManager30(this.$VideoUploadReceiveRequestManager22.getEndOffset()-this.$VideoUploadReceiveRequestManager22.getStartOffset(),this.$VideoUploadReceiveRequestManager14);this.$VideoUploadReceiveRequestManager21.setTimeoutHandler(n,this.__handleResponseTimeout.bind(this));this.$VideoUploadReceiveRequestManager16='sending chunk with timeout = '+n;this.$VideoUploadReceiveRequestManager25=n;}else this.$VideoUploadReceiveRequestManager16='sending chunk without timeout';var o=this.$VideoUploadReceiveRequestManager31();if(c('VideoUploadConfig').resumability_enabled){this.$VideoUploadReceiveRequestManager32(o);}else this.$VideoUploadReceiveRequestManager21.sendChunk(o);}else{this.$VideoUploadReceiveRequestManager16='sending file';this.$VideoUploadReceiveRequestManager21.sendFile(this.$VideoUploadReceiveRequestManager22.getFile().getFileInput());}this.$VideoUploadReceiveRequestManager18.notifyStart();this.inform('request-started',{start_offset:this.$VideoUploadReceiveRequestManager22.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager22.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});};l.prototype.$VideoUploadReceiveRequestManager32=function(m){'use strict';var n=this.$VideoUploadReceiveRequestManager22.getFile(),o=c('md5')(n.getFile().lastModified+n.getFile().name+n.getFile().type+this.$VideoUploadReceiveRequestManager22.getWaterfallID())+'-'+this.$VideoUploadReceiveRequestManager22.getStartOffset()+'-'+this.$VideoUploadReceiveRequestManager22.getEndOffset();this.$VideoUploadReceiveRequestManager17=new (c('ResumableUploadService'))('fb_video',c('VideoUploadConfig').access_token,o,null,null);this.$VideoUploadReceiveRequestManager33();this.$VideoUploadReceiveRequestManager17.resume(m);};l.prototype.$VideoUploadReceiveRequestManager33=function(){'use strict';this.$VideoUploadReceiveRequestManager17.addListener(c('ResumableUploadServiceState.enum').FAIL,function(m){this.__handleServerFailureResponse(m);}.bind(this));this.$VideoUploadReceiveRequestManager17.addListener(c('ResumableUploadServiceState.enum').SUCCESS,function(m){this.$VideoUploadReceiveRequestManager21.setHandle(m);this.$VideoUploadReceiveRequestManager21.sendChunk(null);}.bind(this));this.$VideoUploadReceiveRequestManager17.addListener(c('ResumableUploadServiceState.enum').TRANSPORT_FAILURE,function(m){this.$VideoUploadReceiveRequestManager28(m);}.bind(this));this.$VideoUploadReceiveRequestManager17.addListener(c('ResumableUploadServiceState.enum').PROGRESS,function(event){this.$VideoUploadReceiveRequestManager29(event);}.bind(this));};l.prototype.__getVideoUploadRequest=function(m){'use strict';return new (c('VideoUploadRequest'))(m);};l.prototype.$VideoUploadReceiveRequestManager34=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='setting request to send after'+m;clearTimeout(this.$VideoUploadReceiveRequestManager26);this.$VideoUploadReceiveRequestManager26=setTimeout(this.$VideoUploadReceiveRequestManager23.bind(this),m);};l.prototype.$VideoUploadReceiveRequestManager31=function(){'use strict';if(this.$VideoUploadReceiveRequestManager27)return this.$VideoUploadReceiveRequestManager27;if(c('VideoUploadConfig').resumability_enabled){this.$VideoUploadReceiveRequestManager27=this.$VideoUploadReceiveRequestManager22.getFile().getFile().slice(this.$VideoUploadReceiveRequestManager22.getStartOffset(),this.$VideoUploadReceiveRequestManager22.getEndOffset(),'application/octet-stream');}else this.$VideoUploadReceiveRequestManager27=this.$VideoUploadReceiveRequestManager22.getFile().getChunk(this.$VideoUploadReceiveRequestManager22.getStartOffset(),this.$VideoUploadReceiveRequestManager22.getEndOffset());return this.$VideoUploadReceiveRequestManager27;};l.prototype.__createRequestData=function(m){'use strict';return {video_id:m.getVideoID(),start_offset:m.getStartOffset(),source:m.getSource(),target_id:m.getTargetID(),waterfall_id:m.getWaterfallID(),composer_entry_point_ref:m.getComposerEntryPointRef&&m.getComposerEntryPointRef(),supports_chunking:m.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManager14,partition_start_offset:m.getPartitionStartOffset(),partition_end_offset:m.getPartitionEndOffset()};};l.prototype.__handleSuccessResponse=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='success response received';var n=Date.now()-this.$VideoUploadReceiveRequestManager13;n=n===0?1:n;var o=m.getPayload();if(o.start_offset===this.$VideoUploadReceiveRequestManager22.getEndOffset()){var p=this.$VideoUploadReceiveRequestManager22.getEndOffset()-this.$VideoUploadReceiveRequestManager22.getStartOffset();this.$VideoUploadReceiveRequestManager14=Math.floor(p/n);}else this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager18.notifySuccess();this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManager22.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager22.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager22.setStartOffset(o.start_offset);this.$VideoUploadReceiveRequestManager22.setEndOffset(o.end_offset);this.$VideoUploadReceiveRequestManager22.setLastKnownUploadSpeed(this.$VideoUploadReceiveRequestManager14);this.$VideoUploadReceiveRequestManager21=null;this.$VideoUploadReceiveRequestManager27=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager22.getSupportsChunking())this.$VideoUploadReceiveRequestManager23(true);};l.prototype.__handleServerFailureResponse=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='failure response received';this.$VideoUploadReceiveRequestManager21=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager18.notifyError();if(this.__hasInvalidStartOffsetAndHasRetries(m.getError())){this.$VideoUploadReceiveRequestManager11++;var n=m.getPayload();this.$VideoUploadReceiveRequestManager16='invalid offset response received start='+n.start_offset+' end='+n.end_offset;if(this.$VideoUploadReceiveRequestManager22.getStartOffset()!=n.start_offset||this.$VideoUploadReceiveRequestManager22.getEndOffset()!=n.end_offset){this.$VideoUploadReceiveRequestManager22.setStartOffset(n.start_offset);this.$VideoUploadReceiveRequestManager22.setEndOffset(n.end_offset);this.$VideoUploadReceiveRequestManager27=null;}this.$VideoUploadReceiveRequestManager23();}else if((m.isTransient()||this.$VideoUploadReceiveRequestManager9)&&this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager3){this.$VideoUploadReceiveRequestManager16='transient server error';this.$VideoUploadReceiveRequestManager11++;this.$VideoUploadReceiveRequestManager34(this.$VideoUploadReceiveRequestManager35(this.$VideoUploadReceiveRequestManager8,this.$VideoUploadReceiveRequestManager11));}else this.$VideoUploadReceiveRequestManager36(m);};l.prototype.__handleResponseTimeout=function(m){'use strict';this.inform('request-timeout',{start_offset:this.$VideoUploadReceiveRequestManager22.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager22.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,timeout_retries:this.$VideoUploadReceiveRequestManager12,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager21.abort();this.$VideoUploadReceiveRequestManager21=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager18.notifyTransportError();if(++this.$VideoUploadReceiveRequestManager12<=this.$VideoUploadReceiveRequestManager5){var n=this.$VideoUploadReceiveRequestManager22.getEndOffset()-this.$VideoUploadReceiveRequestManager22.getStartOffset();n=Math.floor(n/2);n=Math.max(n,this.$VideoUploadReceiveRequestManager15);var o=this.$VideoUploadReceiveRequestManager22.getEndOffset();o=Math.min(o,this.$VideoUploadReceiveRequestManager22.getStartOffset()+n);this.$VideoUploadReceiveRequestManager22.setEndOffset(o);this.$VideoUploadReceiveRequestManager27=null;this.$VideoUploadReceiveRequestManager16='resending after timeout with chunksize='+n;this.$VideoUploadReceiveRequestManager23();}else this.$VideoUploadReceiveRequestManager37({error_code:1006,error_description:h._("Your browser appears to be offline. Please check your Internet connection and try again."),error_summary:h._("No network connection"),error_is_transient:true});};l.prototype.__hasInvalidStartOffsetAndHasRetries=function(m){'use strict';return m===k&&this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager3;};l.prototype.$VideoUploadReceiveRequestManager28=function(m){'use strict';this.$VideoUploadReceiveRequestManager18.notifyTransportError();this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager10<this.$VideoUploadReceiveRequestManager2){this.$VideoUploadReceiveRequestManager16='resending after transport failure';this.$VideoUploadReceiveRequestManager10++;this.$VideoUploadReceiveRequestManager21=null;this.$VideoUploadReceiveRequestManager34(this.$VideoUploadReceiveRequestManager35(this.$VideoUploadReceiveRequestManager7,this.$VideoUploadReceiveRequestManager10));}else this.$VideoUploadReceiveRequestManager36(m);};l.prototype.$VideoUploadReceiveRequestManager36=function(m){'use strict';this.$VideoUploadReceiveRequestManager37({error_code:m.getError(),error_description:m.getErrorDescription(),error_summary:m.getErrorSummary(),error_is_transient:m.isTransient()});};l.prototype.$VideoUploadReceiveRequestManager37=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='handling failure error';this.inform('request-failed',m);this.$VideoUploadReceiveRequestManager24();};l.prototype.$VideoUploadReceiveRequestManager29=function(event){'use strict';this.$VideoUploadReceiveRequestManager18.notifyProgress(event);this.inform('request-progressed',{file_size:this.$VideoUploadReceiveRequestManager22.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManager22.getStartOffset(),sent_bytes:event.loaded});};l.prototype.$VideoUploadReceiveRequestManager19=function(event){'use strict';this.inform('online');this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager26)this.$VideoUploadReceiveRequestManager23();};l.prototype.$VideoUploadReceiveRequestManager20=function(event){'use strict';this.inform('offline');};l.prototype.$VideoUploadReceiveRequestManager35=function(m,n){'use strict';return Math.pow(m,n)*1000;};l.prototype.$VideoUploadReceiveRequestManager30=function(m,n){'use strict';var o;if(n>0){o=n;}else o=10;var p=Math.floor(m/o*this.$VideoUploadReceiveRequestManager6/100);return Math.max(p,30000);};f.exports=l;}),null);
__d("VideoUploadRequestContext",[],(function a(b,c,d,e,f,g){function h(){"use strict";this.reset();}h.prototype.setFile=function(i){"use strict";this.$VideoUploadRequestContext1=i;return this;};h.prototype.getFile=function(){"use strict";return this.$VideoUploadRequestContext1;};h.prototype.setMetadata=function(i){"use strict";this.$VideoUploadRequestContext2=i;return this;};h.prototype.getMetadata=function(){"use strict";return this.$VideoUploadRequestContext2;};h.prototype.setVideoID=function(i){"use strict";this.$VideoUploadRequestContext3=i;return this;};h.prototype.getVideoID=function(){"use strict";return this.$VideoUploadRequestContext3;};h.prototype.setStartOffset=function(i){"use strict";this.$VideoUploadRequestContext4=i;return this;};h.prototype.getStartOffset=function(){"use strict";return this.$VideoUploadRequestContext4;};h.prototype.setEndOffset=function(i){"use strict";this.$VideoUploadRequestContext5=i;return this;};h.prototype.getEndOffset=function(){"use strict";return this.$VideoUploadRequestContext5;};h.prototype.setPartitionStartOffset=function(i){"use strict";this.$VideoUploadRequestContext6=i;return this;};h.prototype.getPartitionStartOffset=function(){"use strict";return this.$VideoUploadRequestContext6;};h.prototype.setPartitionEndOffset=function(i){"use strict";this.$VideoUploadRequestContext7=i;return this;};h.prototype.getPartitionEndOffset=function(){"use strict";return this.$VideoUploadRequestContext7;};h.prototype.setTargetID=function(i){"use strict";this.$VideoUploadRequestContext8=i;return this;};h.prototype.getTargetID=function(){"use strict";return this.$VideoUploadRequestContext8;};h.prototype.setSource=function(i){"use strict";this.$VideoUploadRequestContext9=i;return this;};h.prototype.getSource=function(){"use strict";return this.$VideoUploadRequestContext9;};h.prototype.setWaterfallID=function(i){"use strict";this.$VideoUploadRequestContext10=i;return this;};h.prototype.getWaterfallID=function(){"use strict";return this.$VideoUploadRequestContext10;};h.prototype.setComposerEntryPointRef=function(i){"use strict";this.$VideoUploadRequestContext11=i;};h.prototype.getComposerEntryPointRef=function(){"use strict";return this.$VideoUploadRequestContext11;};h.prototype.setSupportsChunking=function(i){"use strict";this.$VideoUploadRequestContext12=i;return this;};h.prototype.getSupportsChunking=function(){"use strict";return this.$VideoUploadRequestContext12;};h.prototype.setSupportsFileAPI=function(i){"use strict";this.$VideoUploadRequestContext13=i;return this;};h.prototype.getSupportsFileAPI=function(){"use strict";return this.$VideoUploadRequestContext13;};h.prototype.setCreatorProduct=function(i){"use strict";this.$VideoUploadRequestContext14=i;return this;};h.prototype.getCreatorProduct=function(){"use strict";return this.$VideoUploadRequestContext14;};h.prototype.setLastKnownUploadSpeed=function(i){"use strict";this.$VideoUploadRequestContext15=i;};h.prototype.getLastKnownUploadSpeed=function(){"use strict";return this.$VideoUploadRequestContext15||0;};h.prototype.setUseParallelChunks=function(i){"use strict";this.$VideoUploadRequestContext16=i;};h.prototype.getUseParallelChunks=function(){"use strict";return this.$VideoUploadRequestContext16;};h.prototype.setIsSphericalVideo=function(i){"use strict";this.$VideoUploadRequestContext17=i;};h.prototype.getIsSphericalVideo=function(){"use strict";return this.$VideoUploadRequestContext17;};h.prototype.setSphericalMetadata=function(i){"use strict";this.$VideoUploadRequestContext18=i;};h.prototype.getSphericalMetadata=function(){"use strict";return this.$VideoUploadRequestContext18;};h.prototype.setEnableOmnistab=function(i){"use strict";this.$VideoUploadRequestContext19=i;};h.prototype.getEnableOmnistab=function(){"use strict";return this.$VideoUploadRequestContext19;};h.prototype.reset=function(){"use strict";this.$VideoUploadRequestContext1=null;this.$VideoUploadRequestContext3=null;this.$VideoUploadRequestContext4=null;this.$VideoUploadRequestContext5=null;this.$VideoUploadRequestContext8=null;this.$VideoUploadRequestContext9=null;this.$VideoUploadRequestContext10=null;this.$VideoUploadRequestContext11=null;this.$VideoUploadRequestContext12=null;this.$VideoUploadRequestContext13=null;this.$VideoUploadRequestContext6=null;this.$VideoUploadRequestContext7=null;this.$VideoUploadRequestContext14=null;this.$VideoUploadRequestContext15=0;this.$VideoUploadRequestContext16=false;this.$VideoUploadRequestContext17=false;this.$VideoUploadRequestContext2={};this.$VideoUploadRequestContext18={};this.$VideoUploadRequestContext19=false;};f.exports=h;}),null);
__d('VideoUploadStartRequestManager',['ArbiterMixin','VideoUploadRequest','FileHasher','performanceNow','mixin','Assert'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o,p,q){'use strict';i.constructor.call(this);this.$VideoUploadStartRequestManager1=k;this.$VideoUploadStartRequestManager2=l;this.$VideoUploadStartRequestManager3=m;this.$VideoUploadStartRequestManager4=0;this.$VideoUploadStartRequestManager5=n;this.$VideoUploadStartRequestManager6=o;this.$VideoUploadStartRequestManager7=p;this.$VideoUploadStartRequestManager8=q;this.$VideoUploadStartRequestManager9=0;}j.prototype.getRequest=function(){'use strict';return this.$VideoUploadStartRequestManager10;};j.prototype.sendRequest=function(k){'use strict';if(this.$VideoUploadStartRequestManager11||this.$VideoUploadStartRequestManager10)return;this.$VideoUploadStartRequestManager12=k;if(this.$VideoUploadStartRequestManager5&&this.$VideoUploadStartRequestManager12.getFile().getFile()&&this.$VideoUploadStartRequestManager12.getFile().getFile().size<this.$VideoUploadStartRequestManager6&&c('FileHasher').isSupported()){this.$VideoUploadStartRequestManager13=c('performanceNow')();this.$VideoUploadStartRequestManager11=new (c('FileHasher'))();this.$VideoUploadStartRequestManager11.hash(this.$VideoUploadStartRequestManager12.getFile().getFile(),function(l){this.$VideoUploadStartRequestManager13=c('performanceNow')()-this.$VideoUploadStartRequestManager13;this.$VideoUploadStartRequestManager14=l.hash;this.$VideoUploadStartRequestManager11.destroy();this.$VideoUploadStartRequestManager11=null;if(!l.hash)this.$VideoUploadStartRequestManager15=l.exception;this.$VideoUploadStartRequestManager16();}.bind(this));}else this.$VideoUploadStartRequestManager16();};j.prototype.$VideoUploadStartRequestManager16=function(){'use strict';this.$VideoUploadStartRequestManager17();this.inform('request-started',{hash_time:this.$VideoUploadStartRequestManager13,hash_exception:this.$VideoUploadStartRequestManager15});};j.prototype.$VideoUploadStartRequestManager17=function(){'use strict';clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=null;this.$VideoUploadStartRequestManager10=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager1).setAllowCrossOrigin(true).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager12,this.$VideoUploadStartRequestManager14)).setWaterfallID(this.$VideoUploadStartRequestManager12.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManager19.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManager20.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManager21.bind(this));this.$VideoUploadStartRequestManager10.send();};j.prototype.__getVideoUploadRequest=function(k){'use strict';return new (c('VideoUploadRequest'))(k);};j.prototype.__getDataToSend=function(k,l){'use strict';return {file_size:k.getFile().getSize(),file_extension:k.getFile().getExtension(),target_id:k.getTargetID(),source:k.getSource(),waterfall_id:k.getWaterfallID(),composer_entry_point_ref:k.getComposerEntryPointRef&&k.getComposerEntryPointRef(),supports_chunking:k.getSupportsChunking(),supports_file_api:k.getSupportsFileAPI(),partition_start_offset:k.getPartitionStartOffset(),partition_end_offset:k.getPartitionEndOffset(),creator_product:k.getCreatorProduct(),original_file_hash:l,spherical:k.getIsSphericalVideo(),spherical_metadata:k.getSphericalMetadata()};};j.prototype.cancelRequest=function(){'use strict';this.$VideoUploadStartRequestManager22();};j.prototype.$VideoUploadStartRequestManager23=function(k){'use strict';clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=setTimeout(this.$VideoUploadStartRequestManager17.bind(this),k);};j.prototype.$VideoUploadStartRequestManager22=function(){'use strict';if(this.$VideoUploadStartRequestManager11){this.$VideoUploadStartRequestManager11.destroy();this.$VideoUploadStartRequestManager11=null;}if(this.$VideoUploadStartRequestManager10){this.$VideoUploadStartRequestManager10.abort();this.$VideoUploadStartRequestManager10=null;}this.$VideoUploadStartRequestManager9=0;this.$VideoUploadStartRequestManager4=0;this.$VideoUploadStartRequestManager12=null;clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=null;};j.prototype.$VideoUploadStartRequestManager24=function(k,l){'use strict';return Math.pow(k,l)*1000;};j.prototype.$VideoUploadStartRequestManager19=function(k){'use strict';var l=k.getPayload();this.inform('request-finished',this.__getSuccessInformData(l));this.$VideoUploadStartRequestManager10=null;c('Assert').isTrue(this.$VideoUploadStartRequestManager11==null,'Unexpected: if file hasher is not null, clean up is required.');};j.prototype.__getSuccessInformData=function(k){'use strict';return {video_id:k.video_id,start_offset:k.start_offset,end_offset:k.end_offset,transport_retries:this.$VideoUploadStartRequestManager4,server_retries:this.$VideoUploadStartRequestManager9,skip_upload:k.skip_upload,hash_time:this.$VideoUploadStartRequestManager13};};j.prototype.$VideoUploadStartRequestManager25=function(k){'use strict';this.inform('request-failed',this.$VideoUploadStartRequestManager26(k));this.$VideoUploadStartRequestManager10=null;c('Assert').isTrue(this.$VideoUploadStartRequestManager11==null,'Unexpected: if file hasher is not null, clean up is required.');};j.prototype.$VideoUploadStartRequestManager20=function(k){'use strict';this.$VideoUploadStartRequestManager10=null;this.$VideoUploadStartRequestManager4=0;if(k.isTransient()&&this.$VideoUploadStartRequestManager9<this.$VideoUploadStartRequestManager7){this.$VideoUploadStartRequestManager9++;this.$VideoUploadStartRequestManager23(this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager8,this.$VideoUploadStartRequestManager9));}else this.$VideoUploadStartRequestManager25(k);};j.prototype.$VideoUploadStartRequestManager21=function(k){'use strict';if(this.$VideoUploadStartRequestManager2===0||this.$VideoUploadStartRequestManager4>=this.$VideoUploadStartRequestManager2){this.$VideoUploadStartRequestManager25(k);}else{this.$VideoUploadStartRequestManager4++;this.$VideoUploadStartRequestManager10=null;this.$VideoUploadStartRequestManager23(this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager3,this.$VideoUploadStartRequestManager4));}};j.prototype.$VideoUploadStartRequestManager26=function(k){'use strict';return {error_code:k.getError(),error_description:k.getErrorDescription(),error_summary:k.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager4,server_retries:this.$VideoUploadStartRequestManager9,error_is_transient:k.isTransient()};};f.exports=j;}),null);
__d('VideoUploadSession',['ArbiterMixin','AsyncRequest','VideoUploadCrashMonitor','VideoUploadFeatureDetector','VideoUploadFileValidator','VideoUploadLogger','VideoUploadMetadataParser','VideoUploadPostRequestManager','VideoUploadReceiveRequestManager','VideoUploadRequestContext','VideoUploadStartRequestManager','WaterfallIDGenerator','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$VideoUploadSession1=k.source;this.$VideoUploadSession2=k.target_id;this.$VideoUploadSession3=k.logging_delay;this.$VideoUploadSession4=k.silent_file_validation;this.$VideoUploadSession5=k.background_upload;this.$VideoUploadSession6=k.actor_id;this.$VideoUploadSession7=k.composer_entry_point_ref;this.$VideoUploadSession8=k.monitor_crashes;this.$VideoUploadSession9=k.isMultiMediaPost;this.$VideoUploadSession10=k.container_type;this.$VideoUploadSession11=k.number_of_partitions;this.$VideoUploadSession12=k.multi_partitioning_enabled;this.$VideoUploadSession13=new (c('VideoUploadFileValidator'))({minSize:k.min_size,maxSize:k.max_size,minLength:k.min_length,maxLength:k.max_length,minWidth:k.min_width,minHeight:k.min_height,extensions:k.extensions,source:k.source,require16to9AspectRatio:k.require_16to9_aspect_ratio,minAspectRatio:k.min_aspect_ratio,maxAspectRatio:k.max_aspect_ratio});this.$VideoUploadSession14=c('VideoUploadFeatureDetector').supportsChunking();this.$VideoUploadSession15=c('VideoUploadFeatureDetector').supportsFileAPI();if(this.$VideoUploadSession14){this.$VideoUploadSession16=k.parallel_chunk_uploads;if(this.$VideoUploadSession16){this.$VideoUploadSession17=k.parallel_chunk_upload_filesize;this.$VideoUploadSession18=k.default_chunk_size;}}else this.$VideoUploadSession16=false;this.$VideoUploadSession19=this.$VideoUploadSession20(k);this.$VideoUploadSession21=this.$VideoUploadSession22(k);if(this.$VideoUploadSession16)if(this.$VideoUploadSession12){var l=0;this.$VideoUploadSession23=[];for(l=0;l<this.$VideoUploadSession11-1;l++)this.$VideoUploadSession23[l]=this.$VideoUploadSession22(k);}else this.$VideoUploadSession23=this.$VideoUploadSession22(k);this.$VideoUploadSession24=this.$VideoUploadSession25(k);}j.prototype.$VideoUploadSession26=function(){'use strict';this.$VideoUploadSession27=[];this.$VideoUploadSession28=[];this.$VideoUploadSession29=[];this.$VideoUploadSession30=[];this.$VideoUploadSession31=[];var k=0;for(k=0;k<this.$VideoUploadSession32-1;k++)this.$VideoUploadSession27.push(false);};j.prototype.$VideoUploadSession33=function(){'use strict';this.$VideoUploadSession34=c('WaterfallIDGenerator').generate();this.$VideoUploadSession35=new (c('VideoUploadLogger'))({actor_id:this.$VideoUploadSession6,source:this.$VideoUploadSession1,waterfall_id:this.$VideoUploadSession34,target_id:this.$VideoUploadSession2,delay:this.$VideoUploadSession3,is_chunked_upload:this.$VideoUploadSession14,composer_entry_point_ref:this.$VideoUploadSession7,container_type:this.$VideoUploadSession10});this.inform('set-waterfall-id',{waterfallID:this.$VideoUploadSession34});};j.prototype.createTestLogger=function(){'use strict';this.$VideoUploadSession33();};j.prototype.getLogger=function(){'use strict';if(!this.$VideoUploadSession35)return null;return this.$VideoUploadSession35;};j.prototype.start=function(k){'use strict';this.$VideoUploadSession36=null;this.$VideoUploadSession37=false;this.$VideoUploadSession38=false;this.$VideoUploadSession39=k;this.$VideoUploadSession40=0;this.$VideoUploadSession41=false;this.$VideoUploadSession42={sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null};this.$VideoUploadSession43=false;this.$VideoUploadSession33();if(this.$VideoUploadSession12)this.$VideoUploadSession32=Math.min(this.$VideoUploadSession11,Math.ceil(this.$VideoUploadSession39.getSize()/this.$VideoUploadSession17));this.__logEvent(c('VideoUploadLogger').EVENT_REQUESTED_UPLOADING);this.inform('upload-requested');var l=new (c('VideoUploadMetadataParser'))(this.$VideoUploadSession39,this.$VideoUploadSession44.bind(this));l.parse();};j.prototype.post=function(k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_POST_REQUEST);this.inform('post-started',k);var l=this.__createPostRequestContext(k);this.$VideoUploadSession24.sendRequest(l);this.$VideoUploadSession45=k;};j.prototype.__createPostRequestContext=function(k){'use strict';var l=new (c('VideoUploadRequestContext'))();this.__setupPostRequestContext(l,k);return l;};j.prototype.__setupPostRequestContext=function(k,l){'use strict';k.setMetadata(l).setVideoID(this.$VideoUploadSession36).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession34).setSupportsChunking(this.$VideoUploadSession14).setCreatorProduct(this.$VideoUploadSession39.getCreatorProduct()).setFile(this.$VideoUploadSession39);if(l){if(l.spherical){this.$VideoUploadSession41=true;k.setIsSphericalVideo(this.$VideoUploadSession41);}if(l.enable_omnistab){this.$VideoUploadSession43=true;k.setEnableOmnistab(this.$VideoUploadSession43);}}if(k.setComposerEntryPointRef)k.setComposerEntryPointRef(this.$VideoUploadSession7);};j.prototype.cancel=function(){'use strict';if(!this.$VideoUploadSession37)return;var k=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession46();if(this.$VideoUploadSession5){if(!this.$VideoUploadSession38)this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_UPLOADING);if(this.$VideoUploadSession47){this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);this.$VideoUploadSession47=false;}}else{this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_UPLOADING);this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);}};j.prototype.abandon=function(){'use strict';if(!this.$VideoUploadSession37)return;var k=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession46();if(this.$VideoUploadSession5){if(!this.$VideoUploadSession38)this.__logEvent(c('VideoUploadLogger').EVENT_ABANDONED_UPLOADING);if(this.$VideoUploadSession47){this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);this.$VideoUploadSession47=false;}}else{this.__logEvent(c('VideoUploadLogger').EVENT_ABANDONED_UPLOADING);this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);}};j.prototype.isPostInProgress=function(){'use strict';return this.$VideoUploadSession24.isInProgress();};j.prototype.isInProgress=function(){'use strict';return this.$VideoUploadSession37;};j.prototype.getVideoID=function(){'use strict';return this.$VideoUploadSession36;};j.prototype.getUploadTime=function(){'use strict';return this.$VideoUploadSession48;};j.prototype.getExPartitionNumber=function(k){'use strict';var l=0;for(l=0;l<this.$VideoUploadSession32-1;l++)if(k>=this.$VideoUploadSession28[l]&&k<this.$VideoUploadSession29[l])break;if(l===this.$VideoUploadSession32)return -1;return l;};j.prototype.startFlow=function(){'use strict';if(!this.$VideoUploadSession5||this.$VideoUploadSession47)return;this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession41?'true':null});this.$VideoUploadSession47=true;if(this.$VideoUploadSession49)this.$VideoUploadSession49.flowStarted();};j.prototype.$VideoUploadSession44=function(k){'use strict';var l,m;if(this.$VideoUploadSession4){var n=this.$VideoUploadSession13.getValidationErrorMessage(this.$VideoUploadSession39,k);if(n){m={error_summary:n.summary,error_description:n.description};l=false;}else l=true;}else l=this.$VideoUploadSession13.validate(this.$VideoUploadSession39,k);if(!l){this.__logEvent(c('VideoUploadLogger').EVENT_INVALIDATED_UPLOADING);this.inform('upload-failed',m);return;}if(k&&k.format){this.$VideoUploadSession41=k.format.isSpherical;if(k.metadata){this.$VideoUploadSession42.sphericalMetadataXml=k.metadata.sphericalMetadataXml;this.$VideoUploadSession42.fbSpatialAudioMetadataXml=k.metadata.fbSpatialAudioMetadataXml;this.$VideoUploadSession42.ytSa3dMetadataJson=k.metadata.ytSa3dMetadataJson;}}if(!this.$VideoUploadSession5)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession41?'true':null});this.$VideoUploadSession50=this.$VideoUploadSession16&&this.$VideoUploadSession39.getSize()>=this.$VideoUploadSession17;this.$VideoUploadSession51=false;this.$VideoUploadSession52=0;this.$VideoUploadSession53=this.$VideoUploadSession52;this.$VideoUploadSession54=0;if(this.$VideoUploadSession12){this.$VideoUploadSession26();}else this.$VideoUploadSession27=false;if(this.$VideoUploadSession50){if(this.$VideoUploadSession12){var o=0;this.$VideoUploadSession55=Math.ceil(this.$VideoUploadSession39.getSize()/this.$VideoUploadSession32);var p=this.$VideoUploadSession55,q=this.$VideoUploadSession55;for(o=0;o<this.$VideoUploadSession32-1;o++){this.$VideoUploadSession28[o]=p;p=Math.min(this.$VideoUploadSession28[o]+q,this.$VideoUploadSession39.getSize());this.$VideoUploadSession29[o]=p;this.$VideoUploadSession30[o]=this.$VideoUploadSession28[o];this.$VideoUploadSession31[o]=0;}}else{this.$VideoUploadSession55=Math.floor(this.$VideoUploadSession39.getSize()/2);this.$VideoUploadSession28=this.$VideoUploadSession55;this.$VideoUploadSession30=this.$VideoUploadSession28;this.$VideoUploadSession31=0;this.$VideoUploadSession29=this.$VideoUploadSession39.getSize();}}else this.$VideoUploadSession55=this.$VideoUploadSession39.getSize();var r=new (c('VideoUploadRequestContext'))().setFile(this.$VideoUploadSession39).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession34).setSupportsChunking(this.$VideoUploadSession14).setSupportsFileAPI(this.$VideoUploadSession15).setCreatorProduct(this.$VideoUploadSession39.getCreatorProduct()).setPartitionStartOffset(this.$VideoUploadSession52).setPartitionEndOffset(this.$VideoUploadSession55);if(this.$VideoUploadSession16)r.setUseParallelChunks(this.$VideoUploadSession16);if(this.$VideoUploadSession41){r.setIsSphericalVideo(this.$VideoUploadSession41);r.setSphericalMetadata(this.$VideoUploadSession42);}if(r.setComposerEntryPointRef)r.setComposerEntryPointRef(this.$VideoUploadSession7);this.$VideoUploadSession56();this.$VideoUploadSession19.sendRequest(r);this.inform('metadata-parsed',k);};j.prototype.$VideoUploadSession20=function(k){'use strict';var l=this.$VideoUploadSession14?k.chunk_start_uri:k.start_uri,m=this.__getVideoUploadStartRequestManager(l,k.start_max_transport_retries,k.start_transport_retry_interval_base,k.skip_upload_enabled,k.skip_upload_file_size_limit,k.start_max_server_retries,k.start_server_retry_interval_base);m.subscribe('request-started',this.$VideoUploadSession57.bind(this));m.subscribe('request-finished',this.$VideoUploadSession58.bind(this));m.subscribe('request-failed',this.$VideoUploadSession59.bind(this));return m;};j.prototype.$VideoUploadSession22=function(k){'use strict';var l=this.$VideoUploadSession14?k.chunk_receive_uri:k.receive_uri,m=this.__getVideoUploadReceiveRequestManager(l,k);m.subscribe('request-started',this.$VideoUploadSession60.bind(this));m.subscribe('request-progressed',this.$VideoUploadSession61.bind(this));m.subscribe('request-finished',this.$VideoUploadSession62.bind(this));m.subscribe('request-failed',this.$VideoUploadSession63.bind(this));m.subscribe('request-timeout',this.$VideoUploadSession64.bind(this));m.subscribe('online',this.$VideoUploadSession65.bind(this));m.subscribe('offline',this.$VideoUploadSession66.bind(this));return m;};j.prototype.$VideoUploadSession25=function(k){'use strict';var l=this.$VideoUploadSession14?k.chunk_post_uri:k.post_uri,m=this.__getVideoUploadPostRequestManager(l,k);m.subscribe('request-finished',this.__handlePostRequestFinished.bind(this));m.subscribe('request-failed',this.$VideoUploadSession67.bind(this));return m;};j.prototype.$VideoUploadSession57=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_UPLOADING,{hash_time:k.hash_time,hash_exception:k.hash_exception});this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_START_REQUEST);this.$VideoUploadSession68=Date.now();this.inform('upload-started');};j.prototype.$VideoUploadSession58=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_PROGRESS_UPLOADING_START_REQUEST,{transport_retries:k.transport_retries,hash_time:k.hash_time,skip_upload:k.skip_upload?1:null});this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_START_REQUEST);this.$VideoUploadSession36=k.video_id;this.$VideoUploadSession69=k.skip_upload;if(!k.skip_upload){var l;l=this.__createReceiveRequestContext(k,false);this.$VideoUploadSession21.sendRequest(l);if(this.$VideoUploadSession50)if(this.$VideoUploadSession12){var m=0;for(m=0;m<this.$VideoUploadSession32-1;m++){l=this.__createReceiveRequestContext(k,true,m);this.$VideoUploadSession23[m].sendRequest(l);}}else{l=this.__createReceiveRequestContext(k,true);this.$VideoUploadSession23.sendRequest(l);}}else{this.inform('upload-progressed',{start_offset:0,end_offset:this.$VideoUploadSession39.getSize(),file_size:this.$VideoUploadSession39.getSize(),sent_bytes:this.$VideoUploadSession39.getSize(),video_id:k.video_id,skip_upload:k.skip_upload});if(this.$VideoUploadSession5)this.__logFinishedUploading();this.inform('upload-finished',{start_offset:0,end_offset:this.$VideoUploadSession39.getSize(),video_id:k.video_id});}};j.prototype.__fetchReceiveRequestManagerStateLogData=function(){'use strict';var k={};if(this.$VideoUploadSession21!=null)this.$VideoUploadSession21.appendStateLogData(k,'requestManager_');if(this.$VideoUploadSession12){var l=0;for(l=0;l<this.$VideoUploadSession32-1;l++)if(this.$VideoUploadSession23[l]!=null)this.$VideoUploadSession23[l].appendStateLogData(k,'requestManagerEx_'+l.toString());}else if(this.$VideoUploadSession23!=null)this.$VideoUploadSession23.appendStateLogData(k,'requestManagerEx_');return k;};j.prototype.__createReceiveRequestContext=function(k,l,m){'use strict';if(!l)l=false;var n=new (c('VideoUploadRequestContext'))();this.$VideoUploadSession12?this.__setupReceiveRequestContext(n,k,l,m):this.__setupReceiveRequestContext(n,k,l);return n;};j.prototype.__setupReceiveRequestContext=function(k,l,m,n){'use strict';var o,p,q,r;if(!m){o=this.$VideoUploadSession52;p=this.$VideoUploadSession55;q=l.start_offset;r=l.end_offset;}else if(this.$VideoUploadSession12){o=this.$VideoUploadSession28[n];p=this.$VideoUploadSession29[n];q=this.$VideoUploadSession28[n];r=this.$VideoUploadSession28[n]+this.$VideoUploadSession18>=this.$VideoUploadSession29[n]?this.$VideoUploadSession29[n]:this.$VideoUploadSession28[n]+this.$VideoUploadSession18;}else{o=this.$VideoUploadSession28;p=this.$VideoUploadSession29;q=this.$VideoUploadSession28;r=this.$VideoUploadSession28+this.$VideoUploadSession18>=this.$VideoUploadSession29?this.$VideoUploadSession29:this.$VideoUploadSession28+this.$VideoUploadSession18;}k.setFile(this.$VideoUploadSession39).setVideoID(l.video_id).setStartOffset(q).setEndOffset(r).setPartitionStartOffset(o).setPartitionEndOffset(p).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession34).setSupportsChunking(this.$VideoUploadSession14);if(this.$VideoUploadSession16)k.setUseParallelChunks(this.$VideoUploadSession16);if(k.setComposerEntryPointRef)k.setComposerEntryPointRef(this.$VideoUploadSession7);};j.prototype.$VideoUploadSession59=function(event,k){'use strict';var l=this.__getLogErrorData(k);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_START_REQUEST,l);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;if(this.$VideoUploadSession5){if(this.$VideoUploadSession47){this.__logEvent(m);this.$VideoUploadSession47=false;}}else this.__logEvent(m);this.$VideoUploadSession70();this.inform('upload-failed',k);};j.prototype.$VideoUploadSession60=function(event,k){'use strict';if(!k.start_offset&&!k.transport_retries&&!k.server_retries)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSession39.getSize()});if(this.$VideoUploadSession14)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,total_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,upload_speed:k.upload_speed});};j.prototype.$VideoUploadSession61=function(event,k){'use strict';if(k.start_offset<this.$VideoUploadSession55){this.$VideoUploadSession53=k.start_offset;this.$VideoUploadSession54=k.sent_bytes;}else if(this.$VideoUploadSession12){var l=0;l=this.getExPartitionNumber(k.start_offset);if(l>-1){this.$VideoUploadSession30[l]=k.start_offset;this.$VideoUploadSession31[l]=k.sent_bytes;}}else{this.$VideoUploadSession30=k.start_offset;this.$VideoUploadSession31=k.sent_bytes;}k.start_offset=this.$VideoUploadSession53;k.sent_bytes=this.$VideoUploadSession54;if(this.$VideoUploadSession50)if(this.$VideoUploadSession12){for(l=0;l<this.$VideoUploadSession32-1;l++){k.start_offset+=this.$VideoUploadSession30[l]-this.$VideoUploadSession28[l];k.sent_bytes+=this.$VideoUploadSession31[l];}}else{k.start_offset+=this.$VideoUploadSession30-this.$VideoUploadSession28;k.sent_bytes+=this.$VideoUploadSession31;}var m=Math.min(k.start_offset+k.sent_bytes,k.file_size);if(m>this.$VideoUploadSession40){this.$VideoUploadSession40=m;this.inform('upload-progressed',k);}};j.prototype.$VideoUploadSession62=function(event,k){'use strict';if(this.$VideoUploadSession14)this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,sent_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,upload_speed:k.upload_speed});var l=false;if(k.start_offset<this.$VideoUploadSession55){this.$VideoUploadSession51=k.end_offset>=this.$VideoUploadSession55;}else if(this.$VideoUploadSession12){var m=0;m=this.getExPartitionNumber(k.start_offset);if(m===-1){var n={error_summary:'Invalid offset',error_description:'Offset doesn\'t fall in any exPartition range.'};this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING);this.inform('upload-failed',n);return;}this.$VideoUploadSession27[m]=k.end_offset>=this.$VideoUploadSession29[m];}else this.$VideoUploadSession27=k.end_offset>=this.$VideoUploadSession29;if(this.$VideoUploadSession12){for(m=0;m<this.$VideoUploadSession32-1;m++)if(this.$VideoUploadSession27[m]===false){l=false;break;}else l=true;}else l=this.$VideoUploadSession27;if(!this.$VideoUploadSession15||this.$VideoUploadSession51&&(!this.$VideoUploadSession50||l)){this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSession39.getSize()});this.$VideoUploadSession48=Date.now()-this.$VideoUploadSession68;if(this.$VideoUploadSession5)this.__logFinishedUploading();k.video_id=this.$VideoUploadSession36;this.inform('upload-finished',k);if(this.$VideoUploadSession9){this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_FLOW);this.$VideoUploadSession47=false;this.$VideoUploadSession70();this.inform('multimedia-upload-finished',k);}}};j.prototype.$VideoUploadSession63=function(event,k){'use strict';var l=this.__getLogErrorData(k);if(this.$VideoUploadSession14)this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_SENDING_CHUNK_BYTES,l);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;if(this.$VideoUploadSession5){if(this.$VideoUploadSession47){this.__logEvent(m);this.$VideoUploadSession47=false;}}else this.__logEvent(m);this.$VideoUploadSession70();this.inform('upload-failed',k);};j.prototype.$VideoUploadSession64=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_TIMEOUT_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,sent_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,timeout_retries:k.timeout_retries,upload_speed:k.upload_speed});};j.prototype.$VideoUploadSession65=function(event,k){'use strict';this.inform('online',k);};j.prototype.$VideoUploadSession66=function(event,k){'use strict';this.inform('offline',k);};j.prototype.__handlePostRequestFinished=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_POST_REQUEST);if(!k.video_id)k.video_id=this.$VideoUploadSession36;if(!this.$VideoUploadSession5)this.__logFinishedUploading();this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_FLOW);this.$VideoUploadSession47=false;this.$VideoUploadSession70();var l=babelHelpers['extends']({},k,this.$VideoUploadSession45);this.inform('post-finished',l);};j.prototype.__logFinishedUploading=function(){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_UPLOADING,{elapsed_time:this.$VideoUploadSession48,skip_upload:this.$VideoUploadSession69?1:null});this.$VideoUploadSession38=true;};j.prototype.$VideoUploadSession67=function(event,k){'use strict';var l=this.__getLogErrorData(k);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_POST_REQUEST,l);if(this.$VideoUploadSession37){this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;this.__logEvent(m);}this.$VideoUploadSession70();this.inform('post-failed',k);};j.prototype.$VideoUploadSession46=function(){'use strict';this.$VideoUploadSession19.cancelRequest();this.$VideoUploadSession21.cancelRequest();if(this.$VideoUploadSession50)if(this.$VideoUploadSession12){var k=0;for(k=0;k<this.$VideoUploadSession32-1;k++)this.$VideoUploadSession23[k].cancelRequest();}else this.$VideoUploadSession23.cancelRequest();this.$VideoUploadSession70();if(this.$VideoUploadSession36){new (c('AsyncRequest'))('/ajax/video/actions/delete').setData({fbid:this.$VideoUploadSession36,redirect:false}).send();this.$VideoUploadSession36=null;}};j.prototype.$VideoUploadSession56=function(){'use strict';this.$VideoUploadSession37=true;if(this.$VideoUploadSession8){this.$VideoUploadSession49=new (c('VideoUploadCrashMonitor'))(this.$VideoUploadSession34,this.$VideoUploadSession6,this.$VideoUploadSession1,this.$VideoUploadSession2,this.$VideoUploadSession3,this.$VideoUploadSession14,this.$VideoUploadSession7,!this.$VideoUploadSession5||this.$VideoUploadSession47);this.$VideoUploadSession49.startSession();}};j.prototype.$VideoUploadSession70=function(){'use strict';this.$VideoUploadSession37=false;if(this.$VideoUploadSession49){this.$VideoUploadSession49.endSession();this.$VideoUploadSession49=null;}};j.prototype.__getLogErrorData=function(k){'use strict';return {error:k.error_summary,error_code:k.error_code,error_description:k.error_description,transport_retries:k.transport_retries,server_retries:k.server_retries};};j.prototype.__logEvent=function(event,k){'use strict';var l=this.getLogger();k=k||{};if(this.$VideoUploadSession39){k.file_size=this.$VideoUploadSession39.getSize();k.file_extension=this.$VideoUploadSession39.getExtension();k.sent_bytes=this.$VideoUploadSession40;}l.logEvent(event,k);};j.prototype.__getVideoUploadStartRequestManager=function(k,l,m,n,o,p,q){'use strict';return new (c('VideoUploadStartRequestManager'))(k,l,m,n,o,p,q);};j.prototype.__getVideoUploadReceiveRequestManager=function(k,l){'use strict';return new (c('VideoUploadReceiveRequestManager'))(k,l.max_transport_retries,l.max_server_retries,l.response_timeout_enabled,l.max_response_timeout_retries,l.response_timeout_speed_variation_factor_ppt,l.transport_retry_interval_base,l.server_retry_interval_base,l.receive_errors_force_retry);};j.prototype.__getVideoUploadPostRequestManager=function(k,l){'use strict';return new (c('VideoUploadPostRequestManager'))(k,l.post_max_transport_retries,l.post_transport_retry_interval_base,l.post_max_server_retries,l.post_server_retry_interval_base);};f.exports=j;}),null);
__d('VideoUploader',['ArbiterMixin','VideoUploadCrashMonitor','VideoUploadSession','arrayContains','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$VideoUploader1=k;this.$VideoUploader2=null;if(k.monitor_crashes){this.$VideoUploader3=new (c('VideoUploadCrashMonitor'))();this.$VideoUploader3.logKnownCrashes();}}j.prototype.getLogger=function(){'use strict';if(!this.$VideoUploader2)return;if(this.$VideoUploader2.getLogger)return this.$VideoUploader2.getLogger();};j.prototype.upload=function(k){'use strict';if(this.$VideoUploader2)return;this.$VideoUploader2=this.__getVideoUploadSession(this.$VideoUploader1);this.$VideoUploader2.subscribe(this.__getEventsWhichShouldListenFromSession(),function(event,l){return this.$VideoUploader4(event,l);}.bind(this));this.$VideoUploader2.start(k);};j.prototype.__getVideoUploadSession=function(k){'use strict';return new (c('VideoUploadSession'))(k);};j.prototype.__getEventsWhichShouldListenFromSession=function(){'use strict';return ['upload-requested','upload-started','upload-progressed','upload-finished','upload-failed','post-started','post-finished','post-failed','online','offline','metadata-parsed','set-waterfall-id'];};j.prototype.postUserRequest=function(){'use strict';if(!this.$VideoUploader2)return;if(this.$VideoUploader2.startFlow)this.$VideoUploader2.startFlow();};j.prototype.post=function(k){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.post(k);};j.prototype.getVideoID=function(){'use strict';return this.$VideoUploader2.getVideoID();};j.prototype.cancel=function(){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.cancel();this.$VideoUploader2=null;};j.prototype.abandon=function(){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.abandon();this.$VideoUploader2=null;};j.prototype.reset=function(){'use strict';this.$VideoUploader2=null;};j.prototype.getUploadSession=function(){'use strict';return this.$VideoUploader2;};j.prototype.getLoggerData=function(){'use strict';return {waterfall_id:this.$VideoUploader2?this.$VideoUploader2.$VideoUploader5:null,actor_id:this.$VideoUploader1.actor_id,target_id:this.$VideoUploader1.target_id,target_type:this.$VideoUploader1.target_type,composer_entry_point_ref:this.$VideoUploader1.composer_entry_point_ref};};j.prototype.isPostInProgress=function(){'use strict';return !!this.$VideoUploader2&&this.$VideoUploader2.isPostInProgress();};j.prototype.isSessionInProgress=function(){'use strict';return !!this.$VideoUploader2&&this.$VideoUploader2.isInProgress();};j.prototype.getUploadParameters=function(){'use strict';return this.$VideoUploader1;};j.prototype.__getSession=function(){'use strict';return this.$VideoUploader2;};j.prototype.__getEventsForWhichSessionShouldBeSetToNull=function(){'use strict';return ['upload-failed','post-finished','multimedia-upload-finished'];};j.prototype.$VideoUploader4=function(event,k){'use strict';if(c('arrayContains')(this.__getEventsForWhichSessionShouldBeSetToNull(),event))this.$VideoUploader2=null;this.__delegateEvent(event,k);};j.prototype.__delegateEvent=function(event,k){'use strict';this.inform(event,k);};f.exports=j;}),null);
__d('ReactComposerOptimisticPostingStoryFailureMessage.react',['cx','fbt','React'],(function a(b,c,d,e,f,g,h,i){var j=function k(){return c('React').createElement('div',{className:"_1rsx"},i._("Your post failed to upload. Please check your Internet connection and refresh the browser to try again."));};f.exports=j;}),null);
__d('ReactComposerOptimisticPostingStoryGeneric.react',['cx','React'],(function a(b,c,d,e,f,g,h){var i=function j(){return c('React').createElement('div',{className:"_3lza"},c('React').createElement('div',{className:"_2iwq"},c('React').createElement('div',{className:"_2iwy"}),c('React').createElement('div',{className:"_2iwz"}),c('React').createElement('div',{className:"_2iw-"}),c('React').createElement('div',{className:"_2iw_"}),c('React').createElement('div',{className:"_2ix0"})));};f.exports=i;}),null);
__d('ReactComposerProfilePhoto.react',['cx','fbt','Image.react','Link.react','React'],(function a(b,c,d,e,f,g,h,i){var j,k,l=c('React').PropTypes,m=40;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;n.prototype.render=function(){'use strict';var o="_3hvt",p=c('React').createElement(c('Image.react'),{className:"_bth",src:this.props.src,height:m,width:m}),q=i._("Profile of {name}",[i.param('name',this.props.profileName)]);return this.props.profileURI?c('React').createElement(c('Link.react'),{'aria-label':q,className:o,href:this.props.profileURI,onClick:this.props.onClick},p):c('React').createElement('div',{className:o},p);};function n(){'use strict';j.apply(this,arguments);}n.propTypes={src:l.string.isRequired,profileName:l.string,profileURI:l.string,onClick:l.func};f.exports=n;}),null);
__d('ReactComposerOptimisticPostingStoryHeader.react',['cx','fbt','Layout.react','ReactComposerProfilePhoto.react','React'],(function a(b,c,d,e,f,g,h,i){var j=c('Layout.react').Column,k=c('Layout.react').FillColumn,l=c('React').PropTypes,m=function o(){},n=function o(p){var q=p.profilePicSrc,r=p.profileName;return c('React').createElement(c('Layout.react'),{className:"_1zm9"},c('React').createElement(j,{className:"_2pii"},c('React').createElement(c('ReactComposerProfilePhoto.react'),{src:q,profileName:r,onClick:m})),c('React').createElement(k,null,c('React').createElement('h6',{className:"_5pbw"},r),c('React').createElement('span',null,i._("Just now"))));};n.propTypes={profilePicSrc:l.string.isRequired,profileName:l.string.isRequired};f.exports=n;}),null);
__d('ReactComposerOptimisticPostingStoryVideo.react',['Bootloader','EventListener','Image.react','JSLog','React','ReactDOM','ifRequired'],(function a(b,c,d,e,f,g){var h,i,j=c('React').PropTypes,k=function m(){};h=babelHelpers.inherits(l,c('React').Component);i=h&&h.prototype;function l(m){'use strict';i.constructor.call(this);this.$ReactComposerOptimisticPostingStoryVideo1=null;this.state={thumbSrc:m.videoUpload.thumbSrc};}l.prototype.componentDidMount=function(){'use strict';if(!this.state.thumbSrc){var m=document.createElement('video');m.setAttribute('src',this.props.videoUpload.fileURL);c('Bootloader').loadModules(["generateVideoThumbnails"],function(){},'ReactComposerOptimisticPostingStoryVideo.react');this.$ReactComposerOptimisticPostingStoryVideo1=c('EventListener').listen(m,'loadedmetadata',this.$ReactComposerOptimisticPostingStoryVideo2.bind(this,m));}};l.prototype.componentWillUnmount=function(){'use strict';this.$ReactComposerOptimisticPostingStoryVideo1&&this.$ReactComposerOptimisticPostingStoryVideo1.remove();};l.prototype.$ReactComposerOptimisticPostingStoryVideo2=function(m){'use strict';var n=c('ReactDOM').findDOMNode(this);c('Bootloader').loadModules(["generateVideoThumbnails"],function(o){o(m,n.clientWidth,n.clientHeight,1).done(function(p){return this.setState({thumbSrc:p.thumbnails[0].getURL()});}.bind(this));}.bind(this),'ReactComposerOptimisticPostingStoryVideo.react');this.$ReactComposerOptimisticPostingStoryVideo1&&this.$ReactComposerOptimisticPostingStoryVideo1.remove();this.$ReactComposerOptimisticPostingStoryVideo1=null;};l.prototype.$ReactComposerOptimisticPostingStoryVideo3=function(){'use strict';return c('React').createElement(c('Image.react'),{src:this.state.thumbSrc});};l.prototype.$ReactComposerOptimisticPostingStoryVideo4=function(){'use strict';return c('ifRequired')('ReactComposerVideoXUploadPlaceholder.react',function(m){return c('React').createElement(m,{onRemoveButtonClicked:k,uploadID:this.props.videoUpload.id,uploadProgress:this.props.videoUpload.progress,uploadState:this.props.videoUpload.state});}.bind(this),function(){c('JSLog').error("ReactComposerVideoXUploadPlaceholderContainer.react isn't "+"loaded when it's supposed to be.");});};l.prototype.render=function(){'use strict';return this.state.thumbSrc&&this.state.thumbSrc.indexOf('data:image/')===0?this.$ReactComposerOptimisticPostingStoryVideo3():this.$ReactComposerOptimisticPostingStoryVideo4();};l.propTypes={videoUpload:j.object.isRequired};f.exports=l;}),null);
__d('ReactComposerOptimisticPostingStoryMedia.react',['cx','Image.react','immutable','React','ReactComposerCollageUtils','ReactComposerMediaUploadType','ReactComposerOptimisticPostingStoryVideo.react'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l=5,m=1000;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.$ReactComposerOptimisticPostingStoryMedia1=function(o){'use strict';if(o.size===0){return [];}else if(o.size===1){return c('ReactComposerCollageUtils').getSingleItemStyleInfo(o.first(),m);}else{var p=c('ReactComposerCollageUtils').getCollageLayoutConfig(o,m);return p.getItemStyleInfos();}};n.prototype.$ReactComposerOptimisticPostingStoryMedia2=function(o){'use strict';var p=0;o.forEach(function(q){var r=q.top+q.height;if(r>p)p=r;});return p/m*100;};n.prototype.$ReactComposerOptimisticPostingStoryMedia3=function(o){'use strict';return o.map(function(p,q){var r=this.props.mediaUploads.get(q),s=p.height/m*100,t=p.width/m*100,u=p.top/m*100,v=p.left/m*100,w=void 0;if(r.mediaType===c('ReactComposerMediaUploadType').VIDEO){w=c('React').createElement(c('ReactComposerOptimisticPostingStoryVideo.react'),{videoUpload:r});}else{var x=r.width/r.height,y=p.width/p.height,z=x>y?{height:'100%'}:{width:'100%'},aa=r.isSpherical&&r.thumbSrc?r.thumbSrc:r.fileURL;w=c('React').createElement(c('Image.react'),{src:aa,style:z});}var ba=null;if(this.props.mediaUploads.size>l&&q===l-1)ba=this.$ReactComposerOptimisticPostingStoryMedia4();return c('React').createElement('div',{key:r.id,className:"_58vp",style:{paddingBottom:''+s+'%',width:''+t+'%',top:''+u+'%',left:''+v+'%'}},w,ba);}.bind(this));};n.prototype.$ReactComposerOptimisticPostingStoryMedia4=function(){'use strict';var o=this.props.mediaUploads.size-l+1;return c('React').createElement('div',{className:"_52d9"},c('React').createElement('div',{className:"_52da"},c('React').createElement('div',{className:"_52db"},'+',o)));};n.prototype.render=function(){'use strict';var o=this.$ReactComposerOptimisticPostingStoryMedia1(this.props.mediaUploads.take(l));return c('React').createElement('div',{className:"_58vq",style:{paddingBottom:''+this.$ReactComposerOptimisticPostingStoryMedia2(o)+'%'}},this.$ReactComposerOptimisticPostingStoryMedia3(o));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={mediaUploads:k.instanceOf(c('immutable').List).isRequired};f.exports=n;}),null);
__d('ReactComposerOptimisticPostingStoryProgress.react',['cx','fbt','BUIProgressBar.react','React'],(function a(b,c,d,e,f,g,h,i){var j=c('React').PropTypes,k=function l(m){var n=m.percent,o=void 0;if(n===null){o={isBuffering:true};}else o={percentage:n};return c('React').createElement('div',{className:"_2oj3"},c('React').createElement('span',null,i._("Uploading...")),c('React').createElement(c('BUIProgressBar.react'),babelHelpers['extends']({className:"_2oj4",flexibleWidth:true},o)));};k.propTypes={percent:j.number};f.exports=k;}),null);
__d('ReactComposerOptimisticPostingStoryStatus.react',['cx','React'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=function l(m){var n=m.status;return c('React').createElement('div',{className:"_4sfj"},c('React').createElement('div',{className:"_5pbx"},n));},k=i.oneOfType([i.number,i.string,i.element,i.arrayOf(k)]);j.PropTypes={status:k.isRequired};f.exports=j;}),null);
__d('ReactComposerOptimisticPostingStoryVideoMessage.react',['cx','fbt','React'],(function a(b,c,d,e,f,g,h,i){var j=function k(){return c('React').createElement('div',{className:"_1rsx"},i._("The video in your post is being processed. We'll send you a notification when it's finished and your post is ready to view."));};f.exports=j;}),null);
__d('ReactComposerOptimisticPostingStoryContainer.react',['cx','Arbiter','React','ReactComponentWithPureRenderMixin','ReactComposerActions','ReactComposerAttachmentType','ReactComposerConfig','ReactComposerEvents','ReactComposerMediaUploadStore','ReactComposerMediaUploadType','ReactComposerOptimisticPostingStore','ReactComposerOptimisticPostingStoryGeneric.react','ReactComposerOptimisticPostingStoryHeader.react','ReactComposerOptimisticPostingStoryMedia.react','ReactComposerOptimisticPostingStoryProgress.react','ReactComposerOptimisticPostingStoryStatus.react','ReactComposerOptimisticPostingStoryVideoMessage.react','ReactComposerOptimisticPostingStoryFailureMessage.react','ReactComposerPhotoStore','ReactComposerPhotoUploadState','ReactComposerStatusStore','ReactComposerStore','ReactComposerVideoUploadStore','StoreBasedStateMixinHelper','XUICard.react'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('React').createClass({displayName:'ReactComposerOptimisticPostingStoryContainer',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{attachmentType:i.string.isRequired,composerID:i.string.isRequired,config:c('ReactComposerConfig').isRequired,targetID:i.string.isRequired,actorID:i.string.isRequired},_mixin:null,_recalculateStateID:null,_mediaUploads:null,_previousPercent:0,getInitialState:function k(){return this._calculateState();},componentDidUpdate:function k(l,m){if(this.state.isOptimisticallyPosting&&!this.state.isUploading&&!this.state.videoFinishedPosting&&this.state.uploadSuccessRate!==0)c('ReactComposerActions').postStarted(this.props.composerID,{actorID:this.props.actorID,config:this.props.config,targetID:this.props.targetID});},componentDidMount:function k(){this._previousPercent=0;this._mixin=new (c('StoreBasedStateMixinHelper'))([c('ReactComposerMediaUploadStore'),c('ReactComposerOptimisticPostingStore'),c('ReactComposerPhotoStore'),c('ReactComposerStore'),c('ReactComposerVideoUploadStore')]);this._mixin.subscribeCallback(function(l){if(this._recalculateStateID===null)this._recalculateStateID=setTimeout(function(){var m=this._calculateState(),n=Math.max(m.percent,this._previousPercent);m.percent=n;this._previousPercent=n;this.setState(m);this._recalculateStateID=null;}.bind(this),0);}.bind(this));if(c('ReactComposerMediaUploadStore')&&c('ReactComposerMediaUploadStore').getUploadsOfType(this.props.composerID,c('ReactComposerMediaUploadType').VIDEO).size)c('Arbiter').subscribeOnce(c('ReactComposerEvents').POST_SUCCEEDED+this.props.composerID,function(){this.setState({videoFinishedPosting:true});}.bind(this));},componentWillUnmount:function k(){this._mixin&&this._mixin.release();this._recalculateStateID&&clearTimeout(this._recalculateStateID);},_calculateState:function k(){var l,m=this,n=null,o=1;if(this.props.attachmentType===c('ReactComposerAttachmentType').MEDIA&&c('ReactComposerMediaUploadStore'))(function(){var s=c('ReactComposerMediaUploadStore').getUploads(m.props.composerID),t=0,u=0,v=0,w=0,x=0;s.forEach(function(aa){if(aa.get('fileSize')!==null){u+=aa.get('fileSize');v+=(aa.progress||0)*aa.get('fileSize');}else{w++;x+=aa.progress||0;}if(aa.state===c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE)t++;});if(w){var y=s.size-w,z=y?u/y:1;u+=z*w;v+=z*x;}if(u)n=v/u;o=t/s.size;})();if(this.props.attachmentType===c('ReactComposerAttachmentType').STATUS)n=100;var p=c('ReactComposerVideoUploadStore').getVideo(this.props.composerID)&&c('ReactComposerStore').isPosting(this.props.composerID),q=c('ReactComposerPhotoStore').isSphericalPhotoUpdating(this.props.composerID),r=c('ReactComposerMediaUploadStore').isUploading(this.props.composerID)||c('ReactComposerPhotoStore').isRecognizing(this.props.composerID)||q||p;return {percent:n,videoFinishedPosting:this.state&&this.state.videoFinishedPosting,isUploading:r,isOptimisticallyPosting:c('ReactComposerOptimisticPostingStore').isOptimisticallyPosting(this.props.composerID),uploadSuccessRate:o};},_renderStatusElement:function k(){var l=c('ReactComposerStatusStore').getMessageText(this.props.composerID),m=[].concat(l.split('\n'));for(var n=1;n<m.length;n+=2)m.splice(n,0,c('React').createElement('br',{key:n}));return c('React').createElement(c('ReactComposerOptimisticPostingStoryStatus.react'),{key:'status',status:m});},_renderMediaElement:function k(){if(!c('ReactComposerMediaUploadStore'))return this._renderGenericElement();if(!this._mediaUploads)this._mediaUploads=c('ReactComposerMediaUploadStore').getUploads(this.props.composerID);var l=c('React').createElement(c('ReactComposerOptimisticPostingStoryMedia.react'),{key:'media',mediaUploads:this._mediaUploads});if(!c('ReactComposerStatusStore').getMessageText(this.props.composerID))return l;return [this._renderStatusElement(),l];},_renderGenericElement:function k(){return c('React').createElement(c('ReactComposerOptimisticPostingStoryGeneric.react'),null);},_renderBody:function k(){var l=void 0;if(this.props.attachmentType===c('ReactComposerAttachmentType').STATUS){l=this._renderStatusElement();}else if(this.props.attachmentType===c('ReactComposerAttachmentType').MEDIA){l=this._renderMediaElement();}else l=this._renderGenericElement();return c('React').createElement('div',{className:"_38-r"},l);},render:function k(){var l=this.props.config.attachmentsConfig[c('ReactComposerAttachmentType').STATUS],m=l.profilePicSrc,n=l.profileName;return c('React').createElement(c('XUICard.react'),{className:"_4rtr"},this.state.videoFinishedPosting?c('React').createElement(c('ReactComposerOptimisticPostingStoryVideoMessage.react'),null):!this.state.isUploading&&this.state.uploadSuccessRate===0?c('React').createElement(c('ReactComposerOptimisticPostingStoryFailureMessage.react'),null):c('React').createElement(c('ReactComposerOptimisticPostingStoryProgress.react'),{percent:this.state.percent}),c('React').createElement(c('ReactComposerOptimisticPostingStoryHeader.react'),{profilePicSrc:m,profileName:n}),this._renderBody());}});f.exports=j;}),null);